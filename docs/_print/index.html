<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.94.0"><link rel=canonical type=text/html href=https://neuro-sevas/neurodesk.github.io/docs/><link rel=alternate type=application/rss+xml href=https://neuro-sevas/neurodesk.github.io/docs/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/neurodesk.github.io/favicons/favicon.ico><link rel=apple-touch-icon href=/neurodesk.github.io/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/neurodesk.github.io/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/neurodesk.github.io/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-192x192.png sizes=192x192><title>Documentation | NeuroDesk</title><meta name=description content="A flexible, scalable and easy to use data analysis environment for reproducible neuroimaging.
"><meta property="og:title" content="Documentation"><meta property="og:description" content="A flexible, scalable and easy to use data analysis environment for reproducible neuroimaging.
"><meta property="og:type" content="website"><meta property="og:url" content="https://neuro-sevas/neurodesk.github.io/docs/"><meta property="og:site_name" content="NeuroDesk"><meta itemprop=name content="Documentation"><meta itemprop=description content="A flexible, scalable and easy to use data analysis environment for reproducible neuroimaging.
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Documentation"><meta name=twitter:description content="A flexible, scalable and easy to use data analysis environment for reproducible neuroimaging.
"><link rel=preload href=/neurodesk.github.io/scss/main.min.8ae326e95d9c6881ebe419ebd82c6634a8ac6728b2415ccd672d345f03b4cb1b.css as=style><link href=/neurodesk.github.io/scss/main.min.8ae326e95d9c6881ebe419ebd82c6634a8ac6728b2415ccd672d345f03b4cb1b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
<link rel=stylesheet href=/neurodesk.github.io/css/prism.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-221108279-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/neurodesk.github.io/><span class=navbar-logo></span><span class="text-uppercase font-weight-bold">NeuroDesk</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/docs/how-to-cite-us/><span>Cite</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/neurodesk.github.io/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/docs/faq/><span>FAQ</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/applications/><span>Applications</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/developers/><span>Developers</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/tutorials/><span>Tutorials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/NeuroDesk target=_blank><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://twitter.com/neuro_desk target=_blank><span>News</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/neurodesk.github.io/offline-search-index.49958059539d8b508473f889b67a882f.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/neurodesk.github.io/docs/>Return to the regular view of this page</a>.</p></div><h1 class=title>Documentation</h1><div class=lead>A flexible, scalable and easy to use data analysis environment for reproducible neuroimaging.</div><ul><li>1: <a href=#pg-985beb153e2fdde0dc6d2053beba66dc>How to cite us</a></li><ul></ul><li>2: <a href=#pg-1c91a59640f4d19bcf14ebed849a10e0>Neurodesk FAQ</a></li><ul></ul><li>3: <a href=#pg-6e17e09fffc1050f46600282def85180>Neurodesk Overview</a></li><ul></ul><li>4: <a href=#pg-ba03213c85edba92d978f939557f31e6>Neurodesktop</a></li><ul><li>4.1: <a href=#pg-0916fe04e84f6b30644efe9a9fa87a91>Getting Started</a></li><ul><li>4.1.1: <a href=#pg-c9662bb32400ec6828eed53f31cf6555>Linux</a></li><li>4.1.2: <a href=#pg-b38c91c080a0eb8d1b287cce61a2913d>MacOS</a></li><li>4.1.3: <a href=#pg-87642ad7e9eab5f4f32e180883213db4>Windows</a></li><li>4.1.4: <a href=#pg-f18fe8cf2e51f4592753190891413c14>HPC</a></li><li>4.1.5: <a href=#pg-2df88396797ed0fed27d3a42d5183c30>Nectar Virtual Desktop Service</a></li><li>4.1.6: <a href=#pg-e87d15c10c240bf068b41cfa086457a9>Visual Studio Code</a></li><li>4.1.7: <a href=#pg-2cb39ae1fe927afd991445cce7b9f813>Cloud</a></li><li>4.1.8: <a href=#pg-7ca92037adea4dd35bf810e5793befd6>Play</a></li></ul><li>4.2: <a href=#pg-a1abf9b90f3887a0021426829e383df4>What's next?</a></li><li>4.3: <a href=#pg-3aab88ee1e48cad88e2180be3e99a33b>What's in the box?</a></li><li>4.4: <a href=#pg-33caca0878e307c0e84289213e7d7ee2>Storage</a></li><li>4.5: <a href=#pg-71c9f282478b9d11471d083fb454cfd4>Troubleshooting</a></li><li>4.6: <a href=#pg-6fcc3ae2c99b700109cf4d44a0a17071>Release History</a></li></ul><li>5: <a href=#pg-216e6b441d02e354a557e95ac5aff8f4>Neurocommand</a></li><ul><li>5.1: <a href=#pg-7dcdaf2682aade0e69b4813cd0359095>Getting Started</a></li><ul><li>5.1.1: <a href=#pg-b25aa0b6f8dfd4ff32d8bffbdca60e3b>Linux</a></li><li>5.1.2: <a href=#pg-180aa3bd9988d06cd8c909d2dd3a6340>Windows</a></li></ul></ul><li>6: <a href=#pg-88405e8e9824a3a23cd8fda56d2e5574>Neurocontainers</a></li><ul><li>6.1: <a href=#pg-895ed1135b9cdc0df128fddec565e375>CVMFS</a></li><li>6.2: <a href=#pg-e6e34ad7485d3730bc92bfaf63f2eb30>Datalad</a></li><li>6.3: <a href=#pg-f18a87ac25493d50d810709d157e5b03>Docker</a></li><li>6.4: <a href=#pg-1242611cf4181d837a23ff9db8482b26>Google Colab</a></li><li>6.5: <a href=#pg-dde076c9513b160da47a52346f74d655>Singularity</a></li><li>6.6: <a href=#pg-032a02c0f4ba2de0dd4a701cff6790fe>Windows 11 and Windows Subsystem for Linux</a></li></ul></ul><div class=content><h2 id=overview>Overview</h2><p>For an overview of the Neurodesk platform, go to: <a href=/docs/overview/>Overview</a></p><h2 id=quick-start>Quick Start</h2><p>To install the Neurodesktop container, go to: <a href=/docs/neurodesktop/getting-started/>Getting Started</a></p><h2 id=feedback--inquiries>Feedback & Inquiries</h2><p>To ask questions or suggest new features, <a href=https://github.com/NeuroDesk/neurodesk.github.io/discussions>join the discussion</a> on github. For issues with the <em>Neurodesk</em> platform, please open a <a href=https://github.com/NeuroDesk/neurodesk.github.io/issues>new issue</a>.</p><h2 id=acknowledgments>Acknowledgments</h2><p><img src=/nif.png alt=nif title=nif></p><p><img src=/uq_logo.png alt=uq title=uq></p><p><img src=/swinburne_uni_logo.png alt=swinburne title=swinburne></p><p><img src=/liege_uni_logo.png alt=liege title=liege></p><h2 id=funding>Funding</h2><p>Thank you to Oracle for Research for providing Oracle Cloud credits and related resources to support this project.</p><img src=https://user-images.githubusercontent.com/4021595/119061922-db877080-ba18-11eb-9882-d53a25ec88ee.png width=250><p>This project is supported by an Australian Research Data Commons (ARDC) Platform project “Australian
Electrophysiology Data Analytics PlaTform (AEDAPT)”.</p><img src=https://user-images.githubusercontent.com/4021595/119062104-3caf4400-ba19-11eb-8211-e2e9ce831a16.png width=250><h2 id=license>License</h2><p>MIT License</p><p>Copyright (c) 2021 NeuroDesk</p><p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &ldquo;Software&rdquo;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p><p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p><p>THE SOFTWARE IS PROVIDED &ldquo;AS IS&rdquo;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-985beb153e2fdde0dc6d2053beba66dc>1 - How to cite us</h1><div class=lead>How should I cite the tools I am using and Neurodesk itself?</div><h2 id=citing-tools>Citing tools</h2><p>We recommend to cite the tool you are using with the version number and the builddate, because this guarantees full reproducibility. You can find this information here: <a href=https://www.neurodesk.org/applications/>https://www.neurodesk.org/applications/</a>. It&rsquo;s also very important to cite the paper of the tool you are using and you find this information in the README.m of each tool.</p><h2 id=citing-neurodesk>Citing Neurodesk</h2><p>Finally you can cite Neurodesk with its version and a link to our website.</p><h2 id=citing-aedapt>Citing AEDAPT</h2><p>If you used any EEG/MEG or electrophysiology tools, please link to the AEDAPT website: <a href=https://www.aedapt.net/>https://www.aedapt.net/</a></p><h2 id=examples>Examples</h2><p>“TGV QSM (v1.0.0_20210629, Langkammer, C; Bredies, K; Poser, BA; Barth, M; Reishofer, G; Fan, AP; Bilgic, B; Fazekas, F; Mainero; C; Ropele, S. Fast Quantitative Susceptibility Mapping using 3D EPI and Total Generalized Variation. Neuroimage. 2015 May 1;111:622-30. doi: 10.1016/j.neuroimage.2015.02.041) was run in Neurodesk (v20220302, <a href=https://www.neurodesk.org/>https://www.neurodesk.org/</a> ).”</p><p>&ldquo;EEGlab (2020.0_20211026, Delorme A & Makeig S (2004) EEGLAB: an open-source toolbox for analysis of single-trial EEG dynamics, Journal of Neuroscience Methods 134:9-21.) was run in Neurodesk (v20220302, <a href=https://www.neurodesk.org/>https://www.neurodesk.org/</a>) part of the AEDAPT project <a href=https://www.aedapt.net/>https://www.aedapt.net/</a>.”</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1c91a59640f4d19bcf14ebed849a10e0>2 - Neurodesk FAQ</h1><div class=lead>Frequently Asked Questions.</div><h2 id=what-is-neurodesk>What is Neurodesk?</h2><p>Neurodesk provides a containerised data analysis environment to facilitate reproducible analysis of neuroimaging data. Analysis pipelines for neuroimaging data typically rely on specific versions of packages and software, and are dependent on their native operating system. These dependencies mean that a working analysis pipeline may fail or produce different results on a new computer, or even on the same computer after a software update. Neurodesk provides a platform in which anyone, anywhere, using any computer can reproduce your original research findings given the original data and analysis code.</p><p>More information:</p><ul><li><a href=/docs/overview/>A Neurodesk Overview</a></li><li>A 2 minute video explaining what Neurodesk is: <a href="https://www.youtube.com/watch?v=JLv_5fycugw">Neurodesk in 2 minutes</a></li><li>An online interactive demo you can try RIGHT NOW in your browser: <a href=https://neurodesk.github.io/docs/neurodesktop/getting-started/play/>https://neurodesk.github.io/docs/neurodesktop/getting-started/play/</a></li></ul><p>In-depth information:</p><ul><li>A 15 minute video explaining what Neurodesk is: <a href=https://youtu.be/2ATgTOsiGdY>Neurodesk in 15 minutes</a></li><li>A 35 minute video explaining the technical details of Neurodesk: <a href=https://youtu.be/V5gAA9NiX_s>Neurodesk in 35 minutes - behind the scenes</a></li></ul><h2 id=how-should-i-cite-the-tools-i-am-using-and-neurodesk-itself>How should I cite the tools I am using and Neurodesk itself?</h2><p><a href=/docs/how-to-cite-us>See here</a></p><h2 id=can-i-run-neurodesk-on-an-hpc-without-docker>Can I run Neurodesk on an HPC without Docker?</h2><p>Yes, our project aims to run on the hardware you have access to. However, without docker support you cannot use our desktop interface <a href=/docs/neurodesktop/getting-started>NeuroDesktop</a> but you can still use the command line interface <a href=https://www.neurodesk.org/docs/neurocommand/getting-started/linux/#command-line-mode-eg-running-on-an-hpc-or-cvl>NeuroCommand on HPC</a>. This works well for batch processing on HPCs once you developed your pipeline in our desktop interface. If your HPC provides a desktop interface you can use all our graphical applications without any issues and the GUIs even work via SSH x-forwarding - it&rsquo;s not the most performant experience, but it works well enough.</p><h2 id=is-there-reduced-performance-when-using-containers>Is there reduced performance when using containers?</h2><p>If you are running containers on Linux there is no performance penalty - on an HPC with a Lustre filesystem it can even be faster to run our containers than running natively on the filesystem (because meta data operations are shifted to the compute node - more information can be found here: Rioux, Pierre, Gregory Kiar, Alexandre Hutton, Alan C. Evans, and Shawn T. Brown. ‘Deploying Large Fixed File Datasets with SquashFS and Singularity’. ArXiv:2002.06129 [Cs], 14 February 2020. <a href=http://arxiv.org/abs/2002.06129.)>http://arxiv.org/abs/2002.06129.)</a>. However, running Neurodesktop on Windows and Mac will have a performance penalty, because Linux runs in a Hypervisor on these systems.</p><h2 id=how-can-i-see-how-much-resources-neurodesk-containers-need>How can I see how much resources Neurodesk containers need?</h2><p>In Linux the containers run as normal processes and you can use htop and top to inspect the resource footprint. For Windows and Mac the information is not readily available and we wrote some information here: <a href=https://www.neurodesk.org/docs/neurodesktop/troubleshooting/#i-got-an-error-message-x-killed>Troubleshooting</a></p><h2 id=how-do-i-get-my-files-in-there>How do I get my files in there?</h2><p>It depends where you are running Neurodesk and where your files are. We provide many different ways from drag-and-drop, to cloud storage to file mounts. An overview about Storage can be found here: <a href=https://www.neurodesk.org/docs/neurodesktop/storage/>Storage in Neurodesk</a></p><h2 id=what-applications-are-included-in-neurodesk>What applications are included in Neurodesk?</h2><p>We provide certain applications as part of the Neurodesktop image (<a href=https://www.neurodesk.org/docs/neurodesktop/whatsinthebox/>https://www.neurodesk.org/docs/neurodesktop/whatsinthebox/</a>) - these are applications that don&rsquo;t work well in containers. The majority of applications are provided via containers and a full list can be found here: <a href=https://www.neurodesk.org/applications/>https://www.neurodesk.org/applications/</a></p><h2 id=freeview-720-crashes-when-i-open-files>Freeview 7.2.0 crashes when I open files</h2><p>Freeview (and Freesurfer!) needs a valid license to work and we are not allowed to distribute a license with Neurodesk!</p><p>So here is how you can run freeview 7.2.0 and open your files:</p><ol><li>apply for a license (<a href=https://surfer.nmr.mgh.harvard.edu/registration.html>https://surfer.nmr.mgh.harvard.edu/registration.html</a>) and paste this license in ~/.license</li></ol><p>then run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>echo &#34;export FS_LICENSE=~/.license&#34; &gt;&gt; ~/.bashrc
</span></span><span style=display:flex><span>then start freeview 7.2.0 and it should all work perfectly.
</span></span></code></pre></div><h2 id=can-i-just-use-the-plain-containers>Can I just use the plain containers?</h2><p>Yes, there are multiple ways of using the containers directly and we provide an overview here: <a href=https://www.neurodesk.org/docs/neurocontainers/>https://www.neurodesk.org/docs/neurocontainers/</a></p><h2 id=how-can-i-contribute-new-containers>How can I contribute new containers?</h2><p>We are still working on making this easier, but the current workflow to add new applications is described here: <a href=https://www.neurodesk.org/developers/new_tools/add_tool/>https://www.neurodesk.org/developers/new_tools/add_tool/</a></p><h2 id=i-couldnt-find-the-information-i-was-looking-for-where-can-i-get-additional-assistance>I couldn&rsquo;t find the information I was looking for. Where can I get additional assistance?</h2><p>Open a Github account, and post your question on the Neurodesk forum:
<a href=https://github.com/NeuroDesk/neurodesk.github.io/discussions>https://github.com/NeuroDesk/neurodesk.github.io/discussions</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-6e17e09fffc1050f46600282def85180>3 - Neurodesk Overview</h1><div class=lead>A flexible, scalable and easy to use data analysis environment for reproducible neuroimaging.</div><h2 id=video-tutorial>Video tutorial</h2><p>Click <a href="https://www.youtube.com/watch?v=JLv_5fycugw">here</a> to watch a 2 minute tutorial video from OHBM 2021</p><h2 id=introduction>Introduction</h2><p>Neurodesk provides a containerised data analysis environment to facilitate reproducible analysis of neuroimaging data. At Neurodesk, we believe that reproducibility should be a fundamental principle underlying neuroscientific data analysis (1). Analysis pipelines for neuroimaging data typically rely on specific versions of packages and software, and are dependent on their native operating system. These dependencies mean that a working analysis pipeline may fail or produce different results on a new computer, or even on the same computer after a software update. Neurodesk provides a platform in which anyone, anywhere, using any computer can reproduce your original research findings given the original data and analysis code.</p><h2 id=what-is-a-container>What is a container?</h2><p>The Neurodesk environment allows users to build and use containers for analysing neuroimaging data. Containers can be compared to virtual machines, in that they allow users to create a virtual, isolated computing environment with an operating system separate to that of the host machine. However, containers differ from virtual machines in that they virtualise software rather than hardware. Practically, this means that container images require few system resources to install, start-up quickly, and are easily portable between computers.</p><p>We recomment watching <a href="https://www.youtube.com/watch?v=HelrQnm3v4g">this excellent short video</a> from the Australian Research Data Commons (ARDC) on research applications of software containers.
To read more about Docker containers, visit <a href=https://www.docker.com/resources/what-container>the Docker webpage</a></p><h2 id=the-neurodesk-ecosystem>The Neurodesk ecosystem</h2><p>The Neurodesk ecosystem includes a number of tools for containerised analysis of neuroimaging data. These include:</p><p><img src=/NeurodeskArchitecture.png alt=architecture title=architecture></p><h3 id=neurodesktop>Neurodesktop</h3><blockquote><p>If you’re new to Neurodesk, we recommend you begin with Neurodesktop.</p></blockquote><p><em>Neurodesktop</em> is a compact Docker container with a browser-accessible virtual desktop that allows you develop and implement data analysis pipelines as though you’re on your own computer. The <em>neurodesktop</em> container has the basic tools required for the analysis of fMRI and EEG data pre-installed.
To get started, see: <a href=/docs/neurodesktop/>Neurodesktop</a></p><h3 id=neurocommand>Neurocommand</h3><p><em>Neurocommand</em> offers the option to install and manage multiple distinct containers for more advanced users who prefer a command-line interface. <em>Neurocommand</em> is the recommended interface for users seeking to use Neurodesk in high performance computing (HPC) environments.</p><p>To get started, see: <a href=/docs/neurocommand/>Neurocommand</a></p><h3 id=transparent-singularity>Transparent-singularity</h3><p>The applications pre-installed in <em>neurodesktop</em> and <em>neurocommand</em> are accessible through <em>transparent-singularity</em>, which allows users to transparently use containerised software as through it were installed natively.</p><p>To find out more about this open-source project, see: <a href=https://github.com/NeuroDesk/transparent-singularity>transparent-singularity</a></p><h3 id=neurocontainers>Neurocontainers</h3><p>The <em>neurocontainers</em> repository contains build scripts for sub-containers which are wrapped around executables for neuroimaging data-analysis software. These neurocontainers can be used in combination with neurocommand or transparent-singularity.</p><p>To get started, see: <a href=/docs/neurocontainers/>Neurocontainers</a></p><h3 id=neurodocker>Neurodocker</h3><p><em>Neurodocker</em> is a command-line program that generates custom Dockerfiles and Singularity recipes for neuroimaging and minifies existing containers.</p><p>To find out more about this open-source project, see: <a href=https://github.com/NeuroDesk/neurodocker>Neurodocker</a></p><h2 id=references>References</h2><ol><li><ol><li>National Academies of Sciences, Engineering, and Medicine. 2019. Reproducibility and Replicability in Science. Washington, DC: The National Academies Press. <a href=https://doi.org/10.17226/25303>https://doi.org/10.17226/25303</a>.</li></ol></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-ba03213c85edba92d978f939557f31e6>4 - Neurodesktop</h1><div class=lead>The plug-and-play, browser-accessible, containerised data analysis environment.</div></div><div class=td-content><h1 id=pg-0916fe04e84f6b30644efe9a9fa87a91>4.1 - Getting Started</h1><div class=lead>Select your operating system to get started with neurodesktop.</div></div><div class=td-content><h1 id=pg-c9662bb32400ec6828eed53f31cf6555>4.1.1 - Linux</h1><div class=lead>Install neurodesktop on Linux</div><h2 id=minimum-system-requirements>Minimum System Requirements</h2><ol><li>At least 3GB free space for neurodesktop base image</li><li>Docker requirements. Details found under <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a></li></ol><h2 id=quickstart>Quickstart</h2><h3 id=1-install-docker>1. Install Docker</h3><p>Install Docker from here: <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a>. Additional information available <a href=#installing-docker>below</a></p><h3 id=2-run-neurodesktop>2. Run Neurodesktop</h3><p>Before the first run, create a local folder where the downloaded applications will be stored, e.g. <code>~/neurodesktop-storage</code></p><p>Then use one of the following options to run Neurodesktop:</p><h4 id=option-1-neurodesktoprun>Option 1: NeuroDesktop.run</h4><p>Download and run the following executable
<a href=https://github.com/NeuroDesk/neurodesktop/raw/main/Linux_run_Neurodesk/NeuroDesktop.run>https://github.com/NeuroDesk/neurodesktop/raw/main/Linux_run_Neurodesk/NeuroDesktop.run</a></p><h4 id=option-2-using-terminal>Option 2: Using Terminal</h4><ol><li>Open a terminal, and type the folowing command to automatically download the neurodesktop container and run it</li></ol><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code></pre><div class="alert alert-primary" role=alert>If you get errors in neurodesktop then check if the ~/neurodesktop-storage directory is writable to all users, otherwise run <code>chmod a+rwx ~/neurodesktop-storage</code></div><ol start=2><li><p>Once neurodesktop is downloaded i.e. <code>guacd[77]: INFO: Listening on host 127.0.0.1, port 4822</code> is displayed in terminal, leave the terminal open and neurodesktop running (i.e., do not press CTRL+C)</p></li><li><p>Open a browser and go to:</p></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>http://localhost:8080/#/?username=user&amp;password=password
</span></span></code></pre></div><div class="alert alert-primary" role=alert><p>If using Chrome, a pop-up may open with the text:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&#34;http://localhost:8080 wants to
</span></span><span style=display:flex><span>See text and images copied to the clipboard&#34;.
</span></span></code></pre></div><p>You should press &ldquo;Allow&rdquo;</p></div><div class="alert alert-primary" role=alert>If using Firefox, you might not be able to paste clipboard content into the virtual desktop from the host computer. In that case, please follow the instructions here:
<a href=https://www.neurodesk.org/docs/neurodesktop/troubleshooting/#the-clipboard-in-firefox-is-not-working-correctly>https://www.neurodesk.org/docs/neurodesktop/troubleshooting/#the-clipboard-in-firefox-is-not-working-correctly</a></div><ol start=4><li><p>Press on &ldquo;Desktop Auto-Resolution&rdquo; under &ldquo;ALL CONNECTIONS&rdquo;</p></li><li><p>If it is the first time you use Neruodesktop, wait until the desktop appears (it may take a few seconds). Otherwise, it should appear instantaneously.</p></li><li><p>Neurodesk is ready to use! Click &ldquo;What&rsquo;s next?&rdquo; on the left of this page for further instructions.</p></li><li><p>For an optimal experience, switch your browser to full-screen mode by following the instructions for your browser here:
<a href=https://www.thewindowsclub.com/open-chrome-edge-or-firefox-browser-in-full-screen-mode>https://www.thewindowsclub.com/open-chrome-edge-or-firefox-browser-in-full-screen-mode</a></p></li></ol><div class="alert alert-primary" role=alert>The browser can be closed anytime, and Neurodesktop will continue running in the background. To reconnect to Neurodesktop, simply start over from step 3 above.</div><h2 id=deleting-neurodesktop>Deleting neurodesktop:</h2><p>When done processing your data it is important to stop and remove the container - otherwise the next start or container update will give an error ("&mldr; The container name &ldquo;/neurodesktop&rdquo; is already in use&mldr;")</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>Notice that any data that were saved outside of /neurodesktop-storage would be lost. Please make sure to move all your data to that folder before deleting neurodesktop.</div><ol><li><p>Click on the terminal from which you ran neurodesktop</p></li><li><p>Press <code>Ctrl-C</code></p></li><li><p>Run:</p></li></ol><pre class="language-shell command-line" data-prompt=$>
<code>docker stop neurodesktop</code>
</pre><ol start=4><li>Run:</li></ol><pre class="language-shell command-line" data-prompt=$>
<code>docker rm neurodesktop</code>
</pre><h2 id=installing-docker>Installing Docker</h2><p>For general installation instructions, refer to <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a></p><h3 id=rhelcentos-yum-based>RHEL/CentOS (yum-based)</h3><p>Refer to <a href=https://docs.docker.com/engine/install/centos/>https://docs.docker.com/engine/install/centos/</a></p><p>One example to install docker in a yum-based distribution could look like this:</p><pre class="language-shell command-line" data-prompt=$>
<code>sudo dnf install -y yum-utils 
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
sudo dnf install docker-ce docker-ce-cli containerd.io
# or if dnf not found: sudo yum install docker-ce docker-ce-cli containerd.io
sudo systemctl enable docker
sudo systemctl start docker
sudo docker version
sudo docker info
sudo groupadd docker
sudo usermod -aG docker $USER
sudo chown root:docker /var/run/docker.sock
newgrp docker</code>
</pre><h3 id=ubuntudebian-apt-based>Ubuntu/Debian (apt-based)</h3><p>Refer to <a href=https://docs.docker.com/engine/install/ubuntu/>https://docs.docker.com/engine/install/ubuntu/</a></p><p>One example to install docker in a apt-based distribution could look like this:</p><pre class="language-shell command-line" data-prompt=$ data-output=5>
<code>sudo apt-get update
sudo apt-get install apt-transport-https ca-certificates curl gnupg lsb-release
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io</code>
</pre><h2 id=gpu-support>GPU support</h2><h3 id=rhelcentos-yum-based-1>RHEL/CentOS (yum-based)</h3><pre class="language-shell command-line" data-prompt=$ data-output=4-9>
<code>sudo yum install nvidia-container-toolkit -y</code>
</pre><h3 id=running-neurodesktop-container-with-gpu>Running neurodesktop container with GPU</h3><pre class="language-shell command-line" data-prompt=$ data-output=2-9>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID="$(id -u)" -e HOST_GID="$(id -g)" \
  -e NVIDIA_VISIBLE_DEVICES=all \
  -e NVIDIA_DISABLE_REQUIRE=1 \
  -p 8080:8080 -h neurodesktop-20220701 \
  vnmd/neurodesktop:20220701</code>
</pre><p>Then inside the neurodesktop container run:</p><pre class="language-shell command-line" data-prompt=$>
<code>
sudo apt update
sudo apt install libcudart10.1
</code>
</pre><p>For a GPU with Nvidia driver Version > 495.29.05:</p><pre class="language-shell command-line" data-prompt=$>
<code>
wget https://developer.download.nvidia.com/compute/cuda/11.5.0/local_installers/cuda_11.5.0_495.29.05_linux.run
sudo sh ./cuda_11.5.0_495.29.05_linux.run
</code>
</pre><h4 id=running-tensorflow-w-gpu>Running tensorflow (w/ GPU)</h4><h5 id=using-tensorflow-python>Using tensorflow (python)</h5><pre class="language-shell command-line" data-prompt=$>
<code>
conda install tensorflow-gpu
python</code>
</pre><pre class="language-python command-line" data-prompt=">>>">
<code>import tensorflow as tf
print("Num GPUs Available: ", len(tf.config.list_physical_devices('GPU')))</code>
</pre><p><img src=https://user-images.githubusercontent.com/4021595/135446560-d135f6ce-b699-4e46-8534-b72b4d9f2d41.png alt=image></p><h5 id=using-tensorflow-singularity-container-in-neurodesktop>Using tensorflow (singularity container in neurodesktop)</h5><pre class="language-shell command-line" data-prompt=$>
<code>singularity pull docker://tensorflow/tensorflow:latest-gpu
singularity run --nv tensorflow_latest-gpu.sif
python</code>
</pre><pre class="language-python command-line" data-prompt=">>>">
<code>import tensorflow as tf
print("Num GPUs Available: ", len(tf.config.list_physical_devices('GPU')))</code>
</pre><p><img src=https://user-images.githubusercontent.com/4021595/135449288-6c3e9bbd-fe5f-4f43-aa4a-8a798ba629e6.png alt=image></p><h2 id=using-an-rdp-client>Using an RDP Client</h2><p>Startup Neurodesktop using the following command:</p><p><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 -p 3390:3389 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code></pre><div class="alert alert-primary" role=alert>If you want to connect via RDP using a different port, replace 3390 in the previous and next step with your port</div></p><p>Open your RDP client and connect to Computer <code>localhost:3390</code></p><p>Use the following details to login if prompted</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>username: user
</span></span><span style=display:flex><span>password: password
</span></span></code></pre></div><h2 id=using-vnc>Using VNC</h2><p>To enable VNC and disable RDP, startup Neurodesktop using the following command:</p><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701 --vnc</code></pre><p>To enable both VNC and RDP, startup Neurodesktop using the following command:</p><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701 --vnc --rdp</code></pre><div class="alert alert-primary" role=alert><p>VNC allows for multiple desktop connections to same instance</p><p>Note: Neurodesktop VNC on the browser currently does not support auto-resolution</p></div><h3 id=using-a-vnc-client>Using a VNC Client</h3><div class="alert alert-warning" role=alert>Needs testing</div><p>Startup Neurodesktop using the following command:</p><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 -p 5901:5901 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701 --vnc</code></pre><p>Open a VNC Client and connect to port 5901</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b38c91c080a0eb8d1b287cce61a2913d>4.1.2 - MacOS</h1><div class=lead>Install neurodesktop on MacOS</div><h2 id=minimum-system-requirements>Minimum System Requirements</h2><ol><li>At least 3GB free space for neurodesktop base image</li><li>An Intel Mac. M1/ARM Macs are not yet supported.</li><li>Docker requirements. Details found under <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a></li></ol><h2 id=quickstart>Quickstart</h2><h3 id=1-install-docker>1. Install Docker</h3><p>Install Docker from here: <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a></p><blockquote><p>Docker for MacOS by default runs with 2GB Memory. For actual workloads, 4GB Memory minimum for docker is highly recommended</p></blockquote><ol><li><p>Open the Docker Desktop and Navigate to the Resources tab. Instructions found at <a href=https://docs.docker.com/desktop/mac/#resources>https://docs.docker.com/desktop/mac/#resources</a></p></li><li><p>Increase the Memory slider from 2.00 GB to 4.00 GB (or greater)</p></li><li><p>Increase Swap slider from 1GB to 2GB (or greater)</p></li></ol><h3 id=2-run-neurodesktop>2. Run Neurodesktop</h3><p>Create a local folder where the downloaded applications will be stored, e.g. ~/neurodesktop-storage</p><ol><li>Open a terminal, and type the folowing command to automatically download the neurodesktop container and run it</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run --shm-size<span style=color:#ce5c00;font-weight:700>=</span>1gb -it --privileged --name neurodesktop -v ~/neurodesktop-storage:/neurodesktop-storage -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701
</span></span></code></pre></div><div class="alert alert-primary" role=alert>There is a bug in docker 3.3.0 for Mac that makes this command not run correctly and there will be no application menu when you start the desktop. Update your docker version when you see this!</div><p>if you get errors in neurodesktop then check if the ~/neurodesktop-storage directory is writable to all users, otherwise run <code>chmod a+rwx ~/neurodesktop-storage</code></p><ol start=2><li><p>Once neurodesktop is downloaded i.e. <code>guacd[77]: INFO: Listening on host 127.0.0.1, port 4822</code> is displayed in terminal, leave the terminal open and neurodesktop running (i.e., do not press CTRL+C)</p></li><li><p>Open a browser and go to:</p></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>http://localhost:8080/#/?username=user&amp;password=password
</span></span></code></pre></div><div class="alert alert-primary" role=alert>We recommend to use Chrome over Firefox as it has an option to hide the Toolbar in full screen mode (go to the menu bar, click on View, and uncheck &ldquo;Always Show Toolbar in Full Screen&rdquo;). This allows for Neurodesktop to truly utilise the whole of your screen.</div><ol start=3><li><p>Press on &ldquo;Desktop Auto-Resolution&rdquo; under &ldquo;ALL CONNECTIONS&rdquo;</p></li><li><p>If it is the first time you use Neruodesktop, wait until the desktop appears (it may take a few seconds). Otherwise, it should appear instantaneously.</p></li><li><p>Neurodesk is ready to use! Click &ldquo;What&rsquo;s next?&rdquo; on the left of this page for further instructions.</p></li></ol><div class="alert alert-primary" role=alert>The browser can be closed anytime, and Neurodesktop will continue to run in the background. To reconnect to Neurodesktop, simply start over from step 3 above.</div><h2 id=deleting-neurodesktop>Deleting neurodesktop:</h2><p>When done processing your data it is important to stop and remove the container - otherwise the next start or container update will give an error ("&mldr; The container name &ldquo;/neurodesktop&rdquo; is already in use&mldr;")</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>Notice that any data that were saved outside of /neurodesktop-storage would be lost. Please make sure to move all your data to that folder before deleting neurodesktop.</div><ol><li><p>Click on the terminal from which you ran neurodesktop</p></li><li><p>Press control-C</p></li><li><p>Type:</p></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker stop neurodesktop
</span></span></code></pre></div><ol start=4><li>Type:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker rm neurodesktop
</span></span></code></pre></div><h2 id=using-an-rdp-client>Using an RDP Client</h2><p>Startup Neurodesktop using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run --shm-size<span style=color:#ce5c00;font-weight:700>=</span>1gb -it --privileged --name neurodesktop -v ~/neurodesktop-storage:/neurodesktop-storage -p 3390:3389 -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701
</span></span></code></pre></div><div class="alert alert-primary" role=alert>If you want to connect via RDP using a different port, replace 3390 in the previous and next step with your port</div><p>Open your RDP client and connect to Computer <code>localhost:3390</code></p><p>Use the following details to login if prompted</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>username: user
</span></span><span style=display:flex><span>password: password
</span></span></code></pre></div><h2 id=using-vnc>Using VNC</h2><p>To enable VNC and disable RDP, startup Neurodesktop using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run --shm-size<span style=color:#ce5c00;font-weight:700>=</span>1gb -it --privileged --name neurodesktop -v ~/neurodesktop-storage:/neurodesktop-storage -e <span style=color:#000>VNC_ENABLE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701
</span></span></code></pre></div><div class="alert alert-primary" role=alert><p>VNC allows for multiple desktop connections to same instance</p><p>Note: Neurodesktop VNC on the browser currently does not support auto-resolution</p></div><h3 id=using-a-vnc-client>Using a VNC Client</h3><div class="alert alert-warning" role=alert>Needs testing</div><p>Startup Neurodesktop using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run --shm-size<span style=color:#ce5c00;font-weight:700>=</span>1gb -it --privileged --name neurodesktop -v ~/neurodesktop-storage:/neurodesktop-storage -e <span style=color:#000>VNC_ENABLE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> -p 5901:5901 -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701
</span></span></code></pre></div><p>Open a VNC Client and connect to port 5901</p></div><div class=td-content style=page-break-before:always><h1 id=pg-87642ad7e9eab5f4f32e180883213db4>4.1.3 - Windows</h1><div class=lead>Install neurodesktop on Windows</div><h2 id=minimum-system-requirements>Minimum System Requirements</h2><ol><li>At least 3GB free space for neurodesktop base image</li><li>Docker requirements. Details found under <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a></li><li>If installing docker using WSL, atleast 20GB space recommended for WSL with Ubuntu</li></ol><h2 id=quickstart>Quickstart</h2><h3 id=1-install-docker>1. Install Docker</h3><p>Install Docker from here: <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a><div class="alert alert-primary" role=alert>The docker installation will reboot your computer a few times and there might be warnings regardings WSL2 and this also might require a few more installation steps that unfortunatley differ for every system. Please get in touch if you are stuck and have a look at our troubleshoot page.</div></p><h3 id=2-run-neurodesktop>2. Run Neurodesktop</h3><p>Use one of the following options to run Neurodesktop:</p><h4 id=option-1-neurodesktopexe>Option 1: NeuroDesktop.exe</h4><p>Download and run the following executable. Be aware: 1) The exe file can trigger your anti virus programs and we are working on this. 2) This exe will always download the latest version of neurodesk. For full reproducibility and control please choose Option 2 :)
<a href=https://github.com/NeuroDesk/neurodesktop/raw/main/Windows_run_Neurodesk/NeuroDesktop.exe>https://github.com/NeuroDesk/neurodesktop/raw/main/Windows_run_Neurodesk/NeuroDesktop.exe</a></p><h4 id=option-2-using-terminal>Option 2: Using Terminal</h4><ol><li>Open a terminal (e.g. Powershell), and type the folowing command to automatically download the neurodesktop container and run it</li></ol><pre class="language-batch command-line" data-prompt=">">
<code>docker run --shm-size=1gb -it --privileged --name neurodesktop -v C:/neurodesktop-storage:/neurodesktop-storage -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code>
</pre><ol start=2><li><p>Once neurodesktop is downloaded i.e. <code>guacd[77]: INFO: Listening on host 127.0.0.1, port 4822</code> is displayed in terminal, leave the terminal open and neurodesktop running (i.e., do not press CTRL+C)</p></li><li><p>Open a browser and go to:</p></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>http://localhost:8080/#/?username=user&amp;password=password
</span></span></code></pre></div><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>We do not recommend the use of the Firefox browser for accessing Neurodesktop on Windows 10, as firefox is not able to access localhost where neurodesk is running.</div><ol start=4><li><p>Press on &ldquo;Desktop Auto-Resolution&rdquo; under &ldquo;ALL CONNECTIONS&rdquo;</p></li><li><p>If it is the first time you use Neruodesktop, wait until the desktop appears (it may take a few seconds). Otherwise, it should appear instantaneously.</p></li><li><p>Neurodesk is ready to use! Click &ldquo;What&rsquo;s next?&rdquo; on the left of this page for further instructions.</p></li><li><p>For an optimal experience, switch your browser to full-screen mode by following the instructions for your browser here:
<a href=https://www.thewindowsclub.com/open-chrome-edge-or-firefox-browser-in-full-screen-mode>https://www.thewindowsclub.com/open-chrome-edge-or-firefox-browser-in-full-screen-mode</a></p></li></ol><div class="alert alert-primary" role=alert>The browser can be closed anytime, and Neurodesktop will continue running in the background. To reconnect to Neurodesktop, simply start over from step 3 above.</div><h2 id=deleting-neurodesktop>Deleting neurodesktop:</h2><p>When done processing your data it is important to stop and remove the container - otherwise the next start or container update will give an error ("&mldr; The container name &ldquo;/neurodesktop&rdquo; is already in use&mldr;")</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>Notice that any data that were saved outside of /neurodesktop-storage would be lost. Please make sure to move all your data to that folder before deleting neurodesktop.</div><ol><li><p>Click on the terminal from which you ran neurodesktop</p></li><li><p>Press control-C</p></li><li><p>Type:</p></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker stop neurodesktop
</span></span></code></pre></div><ol start=4><li>Type:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker rm neurodesktop
</span></span></code></pre></div><h2 id=using-an-rdp-client>Using an RDP Client</h2><p>Startup Neurodesktop using the following command:</p><pre class="language-batch command-line" data-prompt=">">
<code>docker run --shm-size=1gb -it --privileged --name neurodesktop -v C:/neurodesktop-storage:/neurodesktop-storage -p 3390:3389 -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code>
</pre><div class="alert alert-primary" role=alert>If you want to connect via RDP using a different port, replace 3390 in the previous and next step with your port</div><p>Open Windows Remote Desktop Connection and connect to Computer <code>localhost:3390</code> as shown below.</p><p><img src=/neurodesktop/getting-started/win-rdp-1.png alt=win-rdp-1 title=win-rdp-1></p><p>Resolution and multi-monitor settings can be set from the Display tab.</p><p>Once ready, click Connect. This will take you to the following prompt</p><p><img src=/neurodesktop/getting-started/win-rdp-2.png alt=win-rdp-1 title=win-rdp-2></p><p>Use the following details to login</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Session: Xorg
</span></span><span style=display:flex><span>username: user
</span></span><span style=display:flex><span>password: password
</span></span></code></pre></div><h2 id=using-vnc>Using VNC</h2><p>To enable VNC and disable RDP, startup Neurodesktop using the following command:</p><pre class="language-batch command-line" data-prompt=">">
<code>docker run --shm-size=1gb -it --privileged --name neurodesktop -v C:/neurodesktop-storage:/neurodesktop-storage -e VNC_ENABLE=true -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code>
</pre><div class="alert alert-primary" role=alert><p>VNC allows for multiple desktop connections to same instance</p><p>Note: Neurodesktop VNC on the browser currently does not support auto-resolution</p></div><h3 id=using-a-vnc-client>Using a VNC Client</h3><div class="alert alert-warning" role=alert>Needs testing</div><p>Startup Neurodesktop using the following command:</p><pre class="language-batch command-line" data-prompt=">">
<code>docker run --shm-size=1gb -it --privileged --name neurodesktop -v C:/neurodesktop-storage:/neurodesktop-storage -e VNC_ENABLE=true -p 5901:5901 -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code>
</pre><p>Open a VNC Client and connect to port 5901</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f18fe8cf2e51f4592753190891413c14>4.1.4 - HPC</h1><div class=lead>Run neurodesktop in a high performance computing environment</div><p>One way of running this project on HPCs is via <a href=https://www.neurodesk.org/docs/neurocommand/getting-started/linux/>https://www.neurodesk.org/docs/neurocommand/getting-started/linux/</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-2df88396797ed0fed27d3a42d5183c30>4.1.5 - Nectar Virtual Desktop Service</h1><div class=lead>Run neurodesktop in the Nectar Virtual Desktop Service</div><p>This option is only available to Australian researchers.</p><p>Go to <a href=https://desktop.rc.nectar.org.au/>https://desktop.rc.nectar.org.au/</a></p><p>Click on &ldquo;Sign in&rdquo;.</p><p>Choose the AAF option.</p><p>Choose your instituion from the list.</p><p>Provide your email address and password.</p><p>Click on &ldquo;EXPLORE&rdquo;.</p><p>Click &ldquo;VIEW DETAILS&rdquo; under Neurodesktop:
<img src=https://user-images.githubusercontent.com/4021595/150286038-592d6b31-3b9a-4ade-8b2d-824a17ca23b4.png alt=image></p><p>Click &ldquo;CREATE DESKTOP +&rdquo; button on the top right corner.</p><p>Choose the desired availability zone.</p><p>Wait until everything is completed:
<img src=https://user-images.githubusercontent.com/4021595/150286126-2d8f60af-7499-4c69-998a-668c9c34d8c9.png alt=image></p><p>Click &ldquo;OPEN DESKTOP ->&rdquo;:
<img src=https://user-images.githubusercontent.com/4021595/150286383-1c1b8d20-c772-4598-a81b-1ef9e11526b8.png alt=image></p><p>To launch the various applications available in Neurodesktop, follow the instructions here:
<a href=https://www.neurodesk.org/docs/neurodesktop/whats-next/#how-to-launch-applications>https://www.neurodesk.org/docs/neurodesktop/whats-next/#how-to-launch-applications</a></p><p>Good luck!</p></div><div class=td-content style=page-break-before:always><h1 id=pg-e87d15c10c240bf068b41cfa086457a9>4.1.6 - Visual Studio Code</h1><div class=lead>Guide connecting your VS Code environment to Neurodesktop</div><p>Following guide is for connecting to a Neurodesktop using a VS Code installation running on your host machine.</p><blockquote><p>Additional instructions if your Neurodesktop is running remotely (i.e. Cloud, HPC, VM)</p></blockquote><h2 id=pre-requisites>Pre-requisites</h2><p>Visual Studio Code <em>(<a href=https://code.visualstudio.com>https://code.visualstudio.com</a>)</em> installed on your host. Standalone version should work fine</p><p>Install the following VS Code extensions:</p><ul><li><input checked disabled type=checkbox> <a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker">Docker extension</a> (Required)</li><li><input disabled type=checkbox> <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack">Remote development extension pack</a>. Includes the following extensions<ul><li><input checked disabled type=checkbox> <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers">Remote - Containers</a> (Required)</li><li><input disabled type=checkbox> <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh">Remote - SSH</a> (For remote servers)</li><li><input disabled type=checkbox> <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl">Remote - WSL</a> (For windows hosts)</li></ul></li></ul><h2 id=for-remote-servers>For Remote servers</h2><p>Open VS Code</p><p>Open the Command Palette (Ctrl+Shift+P)</p><p>Find <code>Remote-SSH: Connect to Host...</code> and select your remote host</p><blockquote><p>More information on remote hosts available at <a href=https://code.visualstudio.com/docs/remote/ssh>https://code.visualstudio.com/docs/remote/ssh</a></p></blockquote><p>This will open a new VS Code instance connected to the remote host via SSH. You may close the previous VS Code instance.</p><p>Follow the steps in the next section using the new VS Code instance</p><h2 id=connecting-to-neurodesktop>Connecting to Neurodesktop</h2><p>Open VS Code and open a Folder (File > Open Folder)</p><blockquote><p>This can be any folder (e.g. home or project folder). VS Code runs into errors if no folder is opened.</p></blockquote><p>Open the Command Palette (Ctrl+Shift+P).</p><p>Select <code>Remote-Containers: Attach to Running Container</code> from the dropdown panel</p><p>Start typing in &rsquo;neurodesktop. Select <code>/neurodesktop</code> from the list</p><p>This should open a VS Code Window connected to the neurodesktop as a Dev Container.</p><blockquote><p>First time connection will take about a minute, as VS code has to install the VS Code server onto the container. Repeat connections should be faster</p></blockquote><h3 id=first-time-connection>First time connection</h3><blockquote><p>First time connection will default to using neurodesktop root user. We want to default connection to be as the normal user to avoid permission issues.
To check which user is being use, open the terminal in the neurodesktop VS Code and check if the user is <code>user</code> or <code>root</code></p></blockquote><p>Follow the following steps to configure your VS Code to connect to neurodesktop as normal user by default</p><p>Open the Command Palette (Ctrl+Shift+P).</p><p>Select <code>Remote-Containers: Open Container Configuration File</code> from the dropdown panel</p><p>This will open a <code>neurodesktop%3alatest.json</code> file. Overwrite the file with the following contents</p><pre><code>{
	&#34;workspaceFolder&#34;: &#34;/home/user&#34;,
	&#34;remoteUser&#34;: &#34;user&#34;
}
</code></pre><p>Close this VS Code window. Use steps in <a href=https://www.neurodesk.org/docs/neurodesktop/visual-studio-code/#connecting-to-neurodesktop>previous section</a> to connect normally</p><h2 id=useful-additions>Useful Additions</h2><p>A plugin to view neuroimaging data inside VScode is also available:
<img src=https://user-images.githubusercontent.com/4021595/163663250-4e8894c6-ea26-4224-b619-87f5485880c1.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-2cb39ae1fe927afd991445cce7b9f813>4.1.7 - Cloud</h1><div class=lead>Run neurodesktop using Oracle or Azure cloud computing</div><h2 id=minimum-system-requirements>Minimum System Requirements</h2><ol><li>At least 3GB free space for neurodesktop base image</li><li>Docker requirements. Details found under <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a></li></ol><h2 id=quickstart>Quickstart</h2><h3 id=1-connect-to-cloud-server>1. Connect to cloud server</h3><p>On the computer from which you want to access Neurodesktop, open an SSH connection to your cloud instance with port forwarding (USER should be substituted with a username that has admin privileges on the cloud instance, and IP should be substituted with the IP address of the cloud instance)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>ssh -L 8080:127.0.0.1:8080 USER@IP
</span></span></code></pre></div><h3 id=2-install-docker>2. Install Docker</h3><p>Install Docker on the cloud instance from here: <a href=https://docs.docker.com/get-docker/>https://docs.docker.com/get-docker/</a>. Additional information available here: <a href=https://www.neurodesk.org/docs/neurodesktop/getting-started/linux/#installing-docker>https://www.neurodesk.org/docs/neurodesktop/getting-started/linux/#installing-docker</a></p><h3 id=3-run-neurodesktop>3. Run Neurodesktop</h3><p>Create a local folder ~/neurodesktop-storage on the cloud instance to store persistent data (data that will not disappear if neurodesktop is stopped)</p><h4 id=option-1-neurodesktoprun>Option 1: NeuroDesktop.run</h4><p>Download and run the following executable on the cloud instance
<a href=https://github.com/NeuroDesk/neurodesktop/raw/main/Linux_run_Neurodesk/NeuroDesktop.run>https://github.com/NeuroDesk/neurodesktop/raw/main/Linux_run_Neurodesk/NeuroDesktop.run</a></p><h4 id=option-2-using-terminal>Option 2: Using Terminal</h4><ol><li>Open a terminal on the cloud instance, and type the folowing command to automatically download the neurodesktop container and run it</li></ol><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code></pre><div class="alert alert-primary" role=alert>If you get errors in neurodesktop then check if the ~/neurodesktop-storage directory is writable to all users, otherwise run <code>chmod a+rwx ~/neurodesktop-storage</code></div><ol start=2><li>Once neurodesktop is downloaded to the cloud instance (<code>guacd[77]: INFO: Listening on host 127.0.0.1, port 4822</code> is displayed in terminal), leave the terminal open and neurodesktop running (i.e., do not press CTRL+C)</li></ol><div class="alert alert-primary" role=alert>Even if your connection to the cloud instance is broken, and the terminal does not respond anymore, Neurodesktop will still continue running on the cloud insance. When the connection to the cloud instance is re-established, please start over the instructions from step 3 below.</div><ol start=3><li><p>If it is required to set up an SSH tunnel to access the cloud instance, please set up such a tunnel from the computer from which you want to access Neurodesktop (e.g. <code>ssh -L 8080:127.0.0.1:8080 USER@IP</code>)</p></li><li><p>Open a browser on the computer from which you want to access Neurodesktop, and go to:</p></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>http://localhost:8080/#/?username=user&amp;password=password
</span></span></code></pre></div><p>If the computer runs Linux, check specific instructions at <a href=https://www.neurodesk.org/docs/neurodesktop/getting-started/linux/>https://www.neurodesk.org/docs/neurodesktop/getting-started/linux/</a>, Option 2, Step 3.</p><ol start=5><li><p>Press on &ldquo;Desktop Auto-Resolution&rdquo; under &ldquo;ALL CONNECTIONS&rdquo;</p></li><li><p>If it is the first time you use Neruodesktop, wait until the desktop appears (it may take a few seconds). Otherwise, it should appear instantaneously.</p></li><li><p>Neurodesk is ready to use! Click &ldquo;What&rsquo;s next?&rdquo; on the left of this page for further instructions.</p></li><li><p>For an optimal experience, switch your browser to full-screen mode by following the instructions for your browser here (except Mac where full-screen mode is built-in):
<a href=https://www.thewindowsclub.com/open-chrome-edge-or-firefox-browser-in-full-screen-mode>https://www.thewindowsclub.com/open-chrome-edge-or-firefox-browser-in-full-screen-mode</a></p></li></ol><div class="alert alert-primary" role=alert>The browser can be closed anytime, and Neurodesktop will continue running on the cloud instance. To reconnect to Neurodesktop, simply start over from step 4 above.</div><div class="alert alert-primary" role=alert>If your computer hibernates/reboots/etc. or if the network connnection has been temporarily lost, Neurodesktop still continues running on the cloud instance. To reconnect to Neurodesktop, start over from step 3 above.</div><div class="alert alert-primary" role=alert>If you want to connect to the same instance of Neurodesktop from another computer, close the browser in the current computer, and start over from step 3 on the other computer (note that only one computer can access Neurodesktop at a time using the default RDP protocol; for access from multiple computers simultaneously, please re-run Neurodesktop with VNC enabled as explained further below).</div><h2 id=deleting-neurodesktop>Deleting neurodesktop:</h2><p>When done processing your data it is important to stop and remove the container - otherwise the next start or container update will give an error ("&mldr; The container name &ldquo;/neurodesktop&rdquo; is already in use&mldr;")</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>Notice that any data that were saved outside of /neurodesktop-storage would be lost. Please make sure to move all your data to that folder before deleting neurodesktop.</div><ol><li><p>Click on the terminal from which you ran neurodesktop</p></li><li><p>Press Ctrl-C</p></li><li><p>Run:</p></li></ol><pre class="language-shell command-line" data-prompt=$>
<code>sudo docker stop neurodesktop && sudo docker rm neurodesktop</code>
</pre><h2 id=portforwarding-to-an-ios-ipad>Portforwarding to an iOS ipad</h2><p>You can also connect to this cloud instance from your iOS device :) For this install <a href=https://webssh.net/documentation/help/networking/port-forwarding/>https://webssh.net/documentation/help/networking/port-forwarding/</a> and create a tunnel (the tool is free for one connection). Start the docker container in a screen session and then connect to it from your ios device in the browser.</p><h2 id=cloud-provider-specific-tutorials>Cloud-provider specific Tutorials</h2><table><thead><tr><th>Cloud provider</th><th>link</th></tr></thead><tbody><tr><td>Oracle</td><td><a href=https://mri.sbollmann.net/index.php/2020/12/08/run-neurodesk-on-oracle-cloud-free-tier/>https://mri.sbollmann.net/index.php/2020/12/08/run-neurodesk-on-oracle-cloud-free-tier/</a></td></tr><tr><td>Azure</td><td><a href=https://henryjburg.medium.com/neurodesk-running-on-azure-3e38c590a152>https://henryjburg.medium.com/neurodesk-running-on-azure-3e38c590a152</a></td></tr></tbody></table><h2 id=using-an-rdp-client>Using an RDP Client</h2><p>Open an SSH connection to your cloud instance with the following command</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>ssh -L 3390:127.0.0.1:3390 USER@IP
</span></span></code></pre></div><p>Startup Neurodesktop using the following command:</p><p><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 -p 3390:3389 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code></pre><div class="alert alert-primary" role=alert>If you want to connect via RDP using a different port, replace 3390 in the previous two steps and next step with your port</div></p><p>Open your RDP client and connect to Computer <code>localhost:3390</code></p><p>Use the following details to login if prompted</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>username: user
</span></span><span style=display:flex><span>password: password
</span></span></code></pre></div><h2 id=using-vnc>Using VNC</h2><p>To enable VNC and disable RDP, startup Neurodesktop using the following command:</p><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701 --vnc</code></pre><p>To enable both VNC and RDP, startup Neurodesktop using the following command:</p><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701 --vnc --rdp</code></pre><div class="alert alert-primary" role=alert><p>VNC allows for multiple desktop connections to same instance</p><p>Note: Neurodesktop VNC on the browser currently does not support auto-resolution</p></div><h3 id=using-a-vnc-client>Using a VNC Client</h3><div class="alert alert-warning" role=alert>Needs testing</div><p>Startup Neurodesktop using the following command:</p><pre class="language-shell command-line" data-prompt=$ data-output=2-6>
<code>sudo docker run \
  --shm-size=1gb -it --privileged --name neurodesktop \
  -v ~/neurodesktop-storage:/neurodesktop-storage \
  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
  -p 8080:8080 -p 5901:5901 \
  -h neurodesktop-20220701 vnmd/neurodesktop:20220701 --vnc</code></pre><p>Open a VNC Client and connect to port 5901</p></div><div class=td-content style=page-break-before:always><h1 id=pg-7ca92037adea4dd35bf810e5793befd6>4.1.8 - Play</h1><div class=lead>Run a demo of neurodesktop <em>without</em> installing anything</div><p>Click the link below for your own instance of Neurodesk on your browser running on Oracle cloud resources.</p><div class="pageinfo pageinfo-primary"><p><a href="https://play.neurodesk.org/v2/gh/neurodesk/jupyter-neurodesktop-image/main?urlpath=neurodesktop">https://play.neurodesk.org/v2/gh/neurodesk/jupyter-neurodesktop-image/main?urlpath=neurodesktop</a></p></div><p>You can upload data to the desktop by simply drag-and-dropping files on the browser window. Data uploaded during your session are stored on Oracle Cloud, and will be automatically deleted at the end of the session. To download your files before deletion: You need to open the guacamole settings by pressing CTRL-ALT-SHIFT (Control-Command-Shift on Mac). This will open a menu on the side:</p><p><img src=https://user-images.githubusercontent.com/4021595/160577828-0f8ba04e-aed7-4c26-a8d2-baf6c4be317a.png alt={A12EDB8A-3D01-4524-A7B5-24E5E94FB418}></p><p>where you can click on &ldquo;Shared Drive&rdquo;:</p><p><img src=https://user-images.githubusercontent.com/4021595/160577926-06e48896-9301-426a-b7d5-9d3b2df14504.png alt={645953A1-5D11-48C7-9DFB-25D4339EEA34}></p><p>and a click (or double clink on Mac) on the file will start the download.</p><p>You can browse into folders in the shared drive by clicking (double clicking on Mac) on them. To get back to the base of the shared drive, press on the drive icon in the top left of the side menu (just below the &ldquo;Shared Drive&rdquo; title).</p><p>To close the side menu, click on CTRL-ALT-SHIFT once more (Control-Command-Shift on Mac).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a1abf9b90f3887a0021426829e383df4>4.2 - What's next?</h1><div class=lead>Congratulations! You&rsquo;ve installed Neurodesktop. What happens next?</div><p>Now that you’ve installed and launched neurodesktop, you should see a virtual desktop environment in your browser, which might look something like this:</p><p><img src=/Desktop.png alt=desktop title=desktop></p><p>In this linux desktop environment, you can access the menu, launch programs, write analysis code, use version control software (i.e. git) and develop analysis pipelines as though you were on your own computer.</p><h2 id=release>Release</h2><p>Keep a note of the release date of the container image that you installed. Regardless of what operating system you installed neurodesktop into, the release date would have been at the end of the <em>docker run</em> command:</p><p><img src=/version.png alt=version title=version></p><p>We regularly update neurodesktop to make sure it’s running well and has up-to-date software. You can check the <a href=https://www.neurodesk.org/docs/neurodesktop/release-history/>Release History</a> page for details of previous releases. If you’d like to update your container at any time, simply switch out the release number for the version you would like. If you’ve finished working on an analysis pipeline and would like to share it with others, you can point them toward the stable release number that you worked in. That way anyone, on any computer around the world can replicate your analysis pipeline in the exact same computing environment that you developed it in.</p><h2 id=video-tutorial>Video tutorial</h2><p>Click <a href="https://www.youtube.com/watch?v=JLv_5fycugw">here</a> to watch a 2 minute tutorial video from OHBM 2021</p><h2 id=how-to-access-files-from-your-host-computer>How to access files from your Host computer</h2><p>There are various ways of connecting your data to to Neurodesktop. For more information see our Storage section: <a href=/docs/neurodesktop/storage>Storage</a></p><h2 id=how-to-launch-applications>How to launch applications</h2><p>Click on the Launcher icon in bottom-left corner, navigate to the &ldquo;Neurodesk&rdquo; menu and then to the relevant submenu (or &ldquo;All Applications&rdquo; for an alphabetical list of all applications). Navigate to the desired application, and then click on a menu entry. If it is the first time you launch an application, it may take a few seconds until it starts (please be patient!).</p><p>If you choose a menu entry with &ldquo;GUI&rdquo; at the end (e.g., fsleyesGUI 6.0.3), the main GUI interface of the application will open.</p><p>If you choose a menu entry without &ldquo;GUI&rdquo; at the end (e.g., fsl 6.0.3), a terminal window will open, and you can use it to run any of the utilities packaged with the application, including the graphical utilities (e.g., typing &ldquo;fsl&rdquo; to run FSL&rsquo;s main menu). Please be patient when running a utility for the first time; Neurodesk is using a clever system that only downloads the utilities that you are actually using, but this may incur a short delay on the order of seconds.
Also notice that the terminal that opens only allows to run utilities from the one application chosen in the menu. To be able to run utilities from multiple applications in the same terminal (or in the same script), please open a separate terminal by clicking on the terminal icon in the bottom toolbar of Neurodesktop. You will then be able to use the &lsquo;module&rsquo; command in order to load the desired applications.</p><h2 id=how-top-copy-and-paste-text>How top copy and paste text</h2><p>You can copy and paste text within Neurodesktop and between Neurodektop and your host computer using the regular keyboard shortcuts (CTRL+C, CTRL+X, and CTRL+V). Note however that some applications (e.g., command-line terminal) are using other keyboard shortcuts. You can usually find them in the &ldquo;Edit&rdquo; menu of the relevent application.</p><p>Note for Mac Users: You will need to use a combination of CTRL and Command shortcuts in order to copy and paste text between Neurodesktop and the host computer. For example, copy text from your Mac with Command+C and then paste it into Neurodesktop using CTRL+V. For the other way around, you&rsquo;d use CTRL+C in Neurodesktop and then Command+V on the Mac.</p><h2 id=how-to-keep-your-modifications-in-the-container>How to keep your modifications in the container</h2><p>We designed neurodesk with reproducibility as a main goal, so the desktop containers should not be modified if one aims for full reproducibility. However, there is one good option to keep your settings across different container versions: You can write a shell script that installs additional packages and modifies the environment so it&rsquo;s perfect for you. This script can then be re-executed in a new desktop version and will enable a reprudcible customization.</p><p>Another option is to &ldquo;save&rdquo; your docker container including all changes you made. This could be useful when your changes are too difficult to write a shell script or when you do not care about reproducibilty as much and you just want to get the job done. To do this you can commit (<a href=https://docs.docker.com/engine/reference/commandline/commit/>https://docs.docker.com/engine/reference/commandline/commit/</a>) your container and by uploading the container to your own docker hub you could even share it.</p><h2 id=how-to-force-a-complete-container-download-to-your-system>How to force a complete container download to your system</h2><p>To increase speed and reliability of Neurodesktop we mount the application containers from a CVMFS mount and download only the files required to run your current task. Although we aim to keep everything on there reproducible, there might be a reason that you want to fully download the containers to your system. You can force this behaviour by adding another parameter to the docker call: <code>-e CVMFS_DISABLE=true</code></p><p>For windows an example would look like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run --shm-size<span style=color:#ce5c00;font-weight:700>=</span>1gb -it --privileged --name neurodesktop -v C:/neurodesktop-storage:/neurodesktop-storage -e <span style=color:#000>CVMFS_DISABLE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-3aab88ee1e48cad88e2180be3e99a33b>4.3 - What's in the box?</h1><div class=lead>The software available in neurodesktop</div><p>Neurodesktop comes with the essential software required for neuroimaging data analysis pre-installed. Each release is built with the most recent version of these packages available at the build date. Some example packages include:</p><ul><li>Editors and Programming (can be found in menu, or launched from command line by typing their name):<ul><li>code (Visual Studio Code)</li><li>gedit (simple visual editor)</li><li>emacs</li><li>vim</li><li>python</li><li>git</li></ul></li><li>Workflow systems:<ul><li>Nipype (including GraphVis)</li></ul></li><li>Data Syncronisation tools: (See our Storage section for more information: <a href=/docs/neurodesktop/storage>Storage</a>)<ul><li>Rsync</li><li>Rclone <a href=https://rclone.org/>https://rclone.org/</a></li><li>Nextcloud client</li><li>Owncloud client</li><li>Globus personal connect <a href=https://docs.globus.org/how-to/globus-connect-personal-linux/>https://docs.globus.org/how-to/globus-connect-personal-linux/</a><ul><li>installed in /opt/globusconnectpersonal/</li></ul></li></ul></li><li>System Management:<ul><li>Lmod (inlcuding Lua)</li><li>Singularity</li><li>Htop</li></ul></li><li>Misc<ul><li>Imagemagic</li><li>Firefox</li><li>OpenSSH client</li></ul></li></ul><p>The neurodesktop environment is built to be light and fast to download and start-up. Most additional programs are therefore downloaded when they are first used. A list of these packages can be found <a href=https://www.neurodesk.org/applications/>here</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-33caca0878e307c0e84289213e7d7ee2>4.4 - Storage</h1><div class=lead>Add storage to Neurodesktop</div><h1 id=drag-and-drop-support>Drag and Drop support</h1><p>You can drag-and-drop files into the browser window to get files into the Neurodesktop. This will then start a file upload:</p><p><img src=https://user-images.githubusercontent.com/4021595/160577507-b5159bae-13c0-4fbf-85da-0ce55fd481f3.png alt={538BB51E-0FEB-46EA-B1B8-FDF122776735}></p><p>To download files from the desktop using the same mechanism you need to open the guacamole settings by pressing CTRL-ALT-SHIFT (Control-Command-Shift on Mac). This will open a menu on the side:</p><p><img src=https://user-images.githubusercontent.com/4021595/160577828-0f8ba04e-aed7-4c26-a8d2-baf6c4be317a.png alt={A12EDB8A-3D01-4524-A7B5-24E5E94FB418}></p><p>where you can click on &ldquo;Shared Drive&rdquo;:</p><p><img src=https://user-images.githubusercontent.com/4021595/160577926-06e48896-9301-426a-b7d5-9d3b2df14504.png alt={645953A1-5D11-48C7-9DFB-25D4339EEA34}></p><p>and a click (or double clink on Mac) on the file will start the download.</p><p>You can browse into folders in the shared drive by clicking (double clicking on Mac) on them. To get back to the base of the shared drive, press on the drive icon in the top left of the side menu (just below the &ldquo;Shared Drive&rdquo; title).</p><p>To close the side menu, click on CTRL-ALT-SHIFT once more (Control-Command-Shift on Mac).</p><h1 id=data-directory-connection-to-the-host-computer>Data directory connection to the host computer</h1><p>If you are running Neurodesktop on your own hardware there will be a direct connection between the &ldquo;Storage&rdquo; folder on the Destkop, which is a link to &ldquo;/neurodesktop-storage&rdquo; and a &ldquo;neurodesktop-storage&rdquo; folder on your C-drive (Windows) or home directory (Mac/Linux). This connection can be used for data processing and data transfer.</p><h2 id=mounting-external-storage-on-your-host-computer>Mounting external storage on your host-computer</h2><p>The -v C:/neurodesktop-storage:/neurodesktop-storage part of the docker command links the directory &ldquo;neurodesktop-storage&rdquo; on the “C drive” of your Windows computer to the directory /neurodesktop-storage inside the Desktop environment. Everything you store in there will be available inside the desktop and on the host computer. You can also mount additional directories by adding another -v parameter set (e.g. -v D:/moredata:/data) - this will mount the directory moredata from your D drive to /data inside neurodesktop. Improtant: the mountpoint inside neurodesktop should be named /data (or anything from this list: <a href=https://github.com/NeuroDesk/neurocontainers/blob/master/recipes/globalMountPointList.txt>https://github.com/NeuroDesk/neurocontainers/blob/master/recipes/globalMountPointList.txt</a>) - otherwise most of the tools will not be able to access the data.</p><p>Here is an example for Windows adding another storage directory:</p><pre class="language-batch command-line" data-prompt=">">
<code>docker run --shm-size=1gb -it --privileged --name neurodesktop -v C:/neurodesktop-storage:/neurodesktop-storage -v D:/moredata:/data -p 8080:8080 -h neurodesktop-20220701 vnmd/neurodesktop:20220701</code>
</pre><h1 id=cloud-storage>Cloud-storage</h1><p>Another way to get your data into Neurodesktop is to use a cloud storage provider like CloudStor, Dropbox, OneDrive and their sync tools like OwnCloud, Nextcloud or very flexible tools like rclone or davfs2. Another good option could be to utilize Globus for large amounts of data.</p><h2 id=nextcloud-and-owncloud-desktop-clients>Nextcloud and Owncloud desktop clients</h2><p>Under the menu item &ldquo;Accessories&rdquo; you can find &ldquo;Nextcloud&rdquo; and &ldquo;ownCloud&rdquo; desktop sync clients that you can configure with your cloud service accounts.</p><p>To connect for example to your AARNET cloudstor account you can start the ownCloud client and enter the Server Address:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>https://cloudstor.aarnet.edu.au/plus/
</span></span></code></pre></div><p>Then generate an app-password here: <a href="https://cloudstor.aarnet.edu.au/plus/settings/personal?sectionid=security">https://cloudstor.aarnet.edu.au/plus/settings/personal?sectionid=security</a></p><h2 id=mounting-webdav-storage-using-davfs2>Mounting webdav storage using davfs2</h2><p>Another option is to directly mount webdav storage. Here is an example how to mount CloudStor into Neurodesktop:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo mount -t davfs https://cloudstor.aarnet.edu.au/plus/remote.php/webdav/ /data/
</span></span></code></pre></div><p>It then asks you for a username and password, which you can generate here: <a href="https://cloudstor.aarnet.edu.au/plus/settings/personal?sectionid=security">https://cloudstor.aarnet.edu.au/plus/settings/personal?sectionid=security</a></p><h2 id=rclone>Rclone</h2><p>Rclone is a command line tool that enables the interaction with various cloud services. Here is an example how to setup rclone with CloudStor Aarnet:</p><ul><li>start the configuration in a terminal window <code>rclone config</code></li><li>Create a new remote: <code>n</code></li><li>Provide a name for the remote: <code>CloudStor</code></li><li>For the “Storage” option choose: <code>webdav</code></li><li>As “url” set: <code>https://cloudstor.aarnet.edu.au/plus/remote.php/webdav/</code></li><li>As “vendor” set OwnCloud: <code>2</code></li><li>Set your CloudStor username after generating an access token <a href="https://cloudstor.aarnet.edu.au/plus/settings/personal?sectionid=security">https://cloudstor.aarnet.edu.au/plus/settings/personal?sectionid=security</a></li><li>Choose to type in your own password: y</li><li>Enter the Password / Token from the CloudStor App passwords page and confirm it again:</li><li>Leave blank the bearer_token: <code>&lt;hit Enter></code></li><li>No advanced config necessary: <code>&lt;hit Enter></code></li><li>accept the configuration: <code>&lt;hit Enter></code></li><li>Quit the config: <code>q</code></li><li>Now we can download data to the HPC easily: <code>rclone copy --progress --transfers 8 CloudStor:/raw-data-for-science-paper .</code></li><li>or upload data to CloudStor: <code>rclone copy --progress --transfers 8 . CloudStor:/data-processed</code></li></ul><h2 id=globus>Globus</h2><p>We also provide the globus client, so you can transfer large amounts of data between globus endpoints and Neurodesktop. You can configure it by running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>/opt/globusconnectpersonal/globusconnectpersonal-*/globusconnectpersonal
</span></span></code></pre></div><p>Once authenticated you can go to the globus file-manager <a href=https://app.globus.org/file-manager>https://app.globus.org/file-manager</a> and your neurodesktop instance will be an endpoint for globus.</p><h1 id=mount-volume-using-sshfs>Mount volume using SSHFS</h1><p>It is theoretically possible to mount an SSH target inside Neurodesktop, but it&rsquo;s not a very reliable way of mounting storage:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sshfs -o allow_root USER@TARGET_HOST:TARGET_PATH SOURCE_PATH
</span></span></code></pre></div><p>A better option is to use <code>scp</code> and copy data from an SSH endpoint:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>scp /neurodesk/myfile user@remoteserver:/data/
</span></span></code></pre></div><p>An alternative is to mount the SSHFS target into a parent directory on your local machine or VM and then use the -v option in the docker run command to bind the parent directory of the SSHFS mount. NOTE: the SSHFS <em>has</em> to be mounted to a subdirectory inside a parent directory which is then bound to the docker container. If you directly bind to the mounted directory itself, your Neurodesktop container will stop being able to access it if the SSHFS mount disconnects and will not be able to access it again without restarting the Neurodesktop container.</p><p>For example, on a local Linux machine or VM:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sshfs -o allow_root USER@TARGET_HOST:TARGET_PATH/MyData SOURCE_PATH/SSHFS_Mounts/MyData
</span></span></code></pre></div><p>Then add the following line to the docker run command when starting Neurodesktop (note the rshared flag):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>-v /SSHFS_Mounts:/data:rshared <span style=color:#4e9a06>\
</span></span></span></code></pre></div><p>TIP: If you use key pair authentication instead of password for your SSHFS mount, you can use the reconnect flag to reconnect automatically if the connection drops:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sshfs -o <span style=color:#000>IdentityFile</span><span style=color:#ce5c00;font-weight:700>=</span>~/.ssh/id_rsa,allow_root,ServerAliveInterval<span style=color:#ce5c00;font-weight:700>=</span>5,ServerAliveCountMax<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>3</span> USER@TARGET_HOST:TARGET_PATH/MyData SOURCE_PATH/SSHFS_Mounts/MyData
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-71c9f282478b9d11471d083fb454cfd4>4.5 - Troubleshooting</h1><div class=lead>Are you experiencing issues with neurodesktop?</div><p>Neurodesk is an open-source project that is always evolving. If you are experiencing an issue not listed here, please open a <a href=https://github.com/NeuroDesk/neurodesk.github.io/issues>new issue</a>, so that we can aim to solve it and update our help documentation.</p><p>To ask questions or suggest new features, <a href=https://github.com/NeuroDesk/neurodesk.github.io/discussions>join the discussion</a> on github.</p><h2 id=i-cannot-copy-and-paste-text-within-neurodesktop-using-keyboard-shortcuts>I cannot copy and paste text within Neurodesktop using keyboard shortcuts</h2><p>If you&rsquo;re using Mac, you might be trying to use Mac keyboard shortcuts, but Neurodesktop is using Linux keyboard shortcuts (CTRL+C and CTRL+V)</p><p>If you use the terminal, please see &ldquo;I fixed my internet browser clipboard, but copy or paste still do not work in the terminal&rdquo; below.</p><h2 id=copying-text-from-my-host-computer-and-pasting-it-inside-neurodesktop-doesnt-work-in-firefox>Copying text from my host computer and pasting it inside Neurodesktop doesn&rsquo;t work in Firefox</h2><p>This is a &ldquo;feature&rdquo; of firefox and you can disable this &ldquo;feature&rdquo;:</p><ul><li>navigate to <a href=https://about:config>about:config</a> and &ldquo;Accept the Risk and Continue&rdquo; (&ldquo;about:config&rdquo; needs to be entered in the address bar of firefox and hit enter)</li><li>now search for clipboard and then set the following to &ldquo;true&rdquo;:<ul><li>dom.events.asyncClipboard.clipboardItem</li><li>dom.events.asyncClipboard.read</li><li>dom.events.testing.asyncClipboard</li></ul></li></ul><p>Then close firefox and restart. Then the clipboard should work as one would expect.</p><p>If the clipboard still does not work, check &ldquo;I fixed my internet browser clipboard, but &mldr;&rdquo; sections below.</p><h2 id=copy-and-paste-between-my-host-computer-and-neurodesktop-or-vice-versa-doesnt-work-in-chrome-or-edge>Copy and paste between my host computer and Neurodesktop (or vice versa) doesn&rsquo;t work in Chrome or Edge</h2><p>The browsers have a security feature to protect you from something stealing your clipboard content. Depending on your security settings you have to enable it explicitly - it&rsquo;s a little icon in the browser address bar that looks like a clipboard.</p><p>After pressing the icon, you should choose the option shown below in the dialog that opens. After pressing &ldquo;Done&rdquo;, close the current browser tab and open a new one for the changes to take effect.</p><p><img src=https://user-images.githubusercontent.com/4021595/154870249-731f8fe3-474f-43ff-aac4-c460893e4246.png alt=image></p><p>If the clipboard still does not work, check &ldquo;I fixed my internet browser clipboard, but &mldr;&rdquo; sections below.</p><h2 id=i-fixed-my-internet-browser-clipboard-but-copy-or-paste-still-do-not-work-in-the-terminal>I fixed my internet browser clipboard, but copy or paste still do not work in the terminal</h2><p>The terminal is using special keyboard shortcuts, Shift+CTRL+C for copy, and Shift+CTRL+V for paste. Alternatively, you can copy and paste text by using the terminal&rsquo;s &ldquo;Edit&rdquo; menu.</p><h2 id=i-fixed-my-internet-browser-clipboard-but-copy-or-paste-still-do-not-work-in-the-file-browser>I fixed my internet browser clipboard, but copy or paste still do not work in the file browser</h2><p>The copy and paste options in the &ldquo;Edit&rdquo; menu of the file browser are used to copy and paste files, not text. To copy and paste text from/into the file browser application (e.g., copy a path into the path field in the top), use the CTRL+C and CTRL+V keyboard shortcuts.</p><h2 id=i-fixed-my-internet-browser-clipboard-but-copy-or-paste-still-do-not-work-in-a-specificall-applications>I fixed my internet browser clipboard, but copy or paste still do not work in a specific/all applications</h2><p>If you&rsquo;re using Mac, you might be trying to use Mac keyboard shortcuts, but Neurodesktop is using Linux keyboard shortcuts.
For more details, read the &ldquo;Note for Mac users&rdquo; <a href=https://www.neurodesk.org/docs/neurodesktop/whats-next/#how-top-copy-and-paste-text>here</a>.</p><p>If it still does not work, or if your host is Windows or Linux, please report the problem and we will do our best to help you:</p><ol><li>Copy some text from your host computer (CTRL+C, or Command+C)</li><li>Open the Mousepad text editor in Neurodesktop (Start button &ndash;> &ldquo;Accessories&rdquo; &mdash;-> &ldquo;Mousepad&rdquo;)</li><li>Try to paste the text using the menu option &ldquo;Edit&rdquo; &ndash;> &ldquo;Paste&rdquo;</li><li>Try to paste the text again using CTRL+V</li><li>If you don&rsquo;t have one already, please create a Github account <a href=https://github.com/signup>here</a></li><li>Go to our discussion forum <a href=https://github.com/NeuroDesk/neurodesk.github.io/discussions>here</a></li><li>If you are not logged into Github, please log in (upper right corner)</li><li>Press &ldquo;New Discussion&rdquo; button</li><li>In the message that you write, please specify your operating system, your internet browser, the application in question, and if you can copy/paste to Mousepad and how?</li></ol><h2 id=docker-cannot-connect-to-the-docker-daemon-at-unixvarrundockersock-is-the-docker-daemon-running>docker: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?.</h2><p>This is usually a docker-related error, not related to neurodesktop itself. To troubleshoot docker, we can try a simpler container first:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker run hello-world
</span></span></code></pre></div><p>Try the following solutions (in this order, until the above command works)</p><ol><li>Win/Mac: Open docker GUI and accept T&Cs. Check that the docker engine is running</li><li>Close and open the terminal and retry.</li><li>Log out and login again, or restart the machine (current user environment doesnt fully know docker is running)</li><li>Add your user to the OS docker group (current user doesnt have permission to run docker)</li><li>docker.sock permissions need to be changed (raise a github issue <a href=https://github.com/NeuroDesk/neurodesktop/issues/new/choose>here</a>)</li></ol><h2 id=windows-users-wsl-not-installed-properly>Windows users: WSL not installed properly</h2><p>The Docker engine relies on the Windows subsystem for Linux (<a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>WSL</a>) to run on a windows machine.</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>We recommend the <em>manual</em> install instructions, as the simplified install requires an upgrade to a preview build of Windows that may be unstable.</div><p>If WSL is properly installed, the <em>Resources</em> tab of the Docker settings should look something like this:</p><p><img src=/Troubleshooting/Docker_WSL_correct.png alt=Docker_WSL_correct title=Docker_WSL_correct></p><p>However, if WSL is missing or incorrectly configured, the <em>Resources</em> tab of the Docker settings may look something like this:</p><p><img src=/Troubleshooting/Docker_WSL_incorrect.png alt=Docker_WSL_incorrect title=Docker_WSL_incorrect></p><p>If this is the case, follow the manual install instructions to install <a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>WSL 2</a> (including installation of Ubuntu through Microsoft Store).</p><h2 id=windows-users-not-enough-free-space-on-the-partition-in-windows-and-wsl2>Windows users: Not enough free space on the partition in Windows and WSL2</h2><p>This could help: <a href=https://yjmantilla.github.io/tutorials/wsl2-move-vhdx.html>https://yjmantilla.github.io/tutorials/wsl2-move-vhdx.html</a></p><h2 id=windows-users-failure-to-connect-to-neurodesktop-in-firefox>Windows users: Failure to connect to Neurodesktop in Firefox</h2><p>We recommend using Microsoft Edge or Google Chrome to access Neurodesktop.</p><h2 id=trouble-installing-neurodesk-images>Trouble installing neurodesk images</h2><p>This may be a memory issue. First, ensure that there is enough free space on the disk. If there is, try resetting docker settings and data. To do this:</p><ol><li>Open the docker engine</li><li>Navigate to &ldquo;Troubleshooting&rdquo; (the bug icon in the top right).</li><li>Click &ldquo;Reset to factory defaults&rdquo;</li></ol><p><img src=/Troubleshooting/Docker_troubleshooting.png alt=Docker_troubleshooting title=Docker_troubleshooting></p><p>If you are still experiencing issues after this, you may need to update docker to the latest version. This can be achieved through &ldquo;settings&rdquo; in the docker engine, or (on windows) by right clicking on the docker tray icon:</p><p><img src=/Troubleshooting/Docker_update.png alt=Docker_update title=Docker_update></p><h2 id=i-got-an-error-message-x-killed-or-not-enough-memory>I got an error message &lsquo;X killed&rsquo; or not enough memory</h2><p>This may be due to Docker not having access to enough RAM from your host computer.</p><h3 id=if-you-are-using-docker-on-macos>If you are using Docker on MacOS</h3><ol><li>The memory amount is managed via the Docker settings:
<img src=https://user-images.githubusercontent.com/4021595/154880061-cff2dde0-632d-4d8c-b627-28df6b074f48.png alt=image></li></ol><h3 id=if-you-are-using-docker-on-windows-10-with-the-wsl2-backend>If you are using Docker on Windows 10 with the WSL2 backend</h3><p>then this is managed by Windows settings. Try the following steps to check how much RAM Docker has access to and increase the amount if necessary.</p><ol><li>Run Docker</li><li>Open a terminal (ie. Powershell) in the PC you want to use to run Neurodesktop (not in Neurodesktop itself) and type the following command:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker info
</span></span></code></pre></div><p>This will generate information about your Docker installation (make sure Docker is running during this step)</p><ol start=3><li>Look for the line that says</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Total Memory: **.**GiB
</span></span></code></pre></div><ol start=4><li>If this value is ~2GB, try increasing it*:<ul><li>Create a .wslconfig file in your user directory (for more detail instructions see: <a href=https://docs.microsoft.com/en-us/windows/wsl/wsl-config>https://docs.microsoft.com/en-us/windows/wsl/wsl-config</a>)</li><li>In the .wslconfig file include the following lines:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[wsl2]
</span></span><span style=display:flex><span>memory=32GB
</span></span></code></pre></div><ul><li>Quit Docker (make sure it&rsquo;s not running in the background, ie. system tray, check task manager)</li><li>In the terminal, run the following command</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>wsl --running --list
</span></span></code></pre></div>This will list any running distributions. For the update to be successful, WSL needs to have comletely stopped running (ie. no distributions running)<ul><li>Restart Docker and rerun steps 1-3 to confirm it was successful</li></ul></li></ol><h3 id=if-you-are-not-using-wsl2-you-can-check-and-manage-your-ram-allocation-in-the-docker-desktop-application>If you are not using WSL2, you can check and manage your RAM allocation in the Docker desktop application.</h3><ol><li>Open the Docker application and navigate to settings > resources > advances</li><li>Scroll down to the Memory option and use the sliding bar to adjust the setting</li><li>Click apply and restart</li></ol><p>*RAM requirements will vary based on the tools/data you are using. If the system you&rsquo;re using has limited RAM, test out a few different amounts by running the above steps and then your analyses in Neurodesktop. Version 20220208 onwards has a memory monitor in the taskbar - you can use this to check how much memory Neurodesktop has access to and how much is being used by the analyses being run.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6fcc3ae2c99b700109cf4d44a0a17071>4.6 - Release History</h1><div class=lead>Previous releases of neurodesktop</div><h2 id=development>development</h2><ul><li>updated qsmxt to 1.1.12</li><li>updated 3D Slicer to 5.0.3 and included MONAI Label</li><li>added Matlab 2022a</li><li>updated AFNI to 22.1.14</li><li>updated Spinal Cord Toolbox to 5.7</li><li>updated Oshyx to 0.4</li></ul><h2 id=20220701>20220701</h2><ul><li>added laynii 2.2.1 - layer fMRI toolbox (contributed by Renzo Huber)</li><li>added fieldtrip 20220617 - eeg processing (contributed by David White)</li></ul><h2 id=20220329>20220329</h2><ul><li>added bidscoin 3.7.0 (converting data to bids) contributed by Oren</li><li>added sigviewer 0.6.4 (viewing electrophysiological data) contributed by Tom</li><li>added niftyreg 1.4.0 (image registration tool) contributed by Steffen</li><li>added mne 1.0.0 (EEG processing pipeline) contributed by David</li></ul><h2 id=20220302>20220302</h2><ul><li>update of ROMEO (phase unwrapping) to latest version 3.2.8</li><li>update of QSMxT (automated end-to-end QSM procerssing) to latest version 1.1.10</li><li>added mritools 3.3.0 (includes clearswi 1.0.1, mcpc3ds 0.1.0, romeo 3.2.8 as compiled binaries)</li></ul><h2 id=20220222>20220222</h2><ul><li>update for PhysIO toolbox (physiological noise correction for fMRI) to r2021a including the latest SPM r8224</li><li>update of lcmodel to include basis sets for 1.5-9.4T</li><li>added a memory display plugin to illustrate how much memory is available to the container and how much is consumed</li><li>added a version checker to help with identifying if a new version is available</li><li>added file upload via guacamole (+ update of guacamole to 1.4) - users can now drag and drop their files onto guacamole and they get copied to the desktop</li></ul><h2 id=20220128>20220128</h2><ul><li>update of Spinalcordtoolbox to 5.5</li><li>update of CAT12 to r1933</li></ul><h2 id=20220121>20220121</h2><ul><li>MNE Python 0.23.4 container including VScode and extensions</li><li>VScode container including Python/Julia Extensions and singularity to test &ldquo;Inception Mode&rdquo; (Running singularity containers withtin singularity containers)</li><li>update of fsl to 6.0.5.1</li><li>added CAT12 (a software that allows estimation of tissue volumes (and additional surface parameters such as cortical thickness, gyrification or fractal dimension) for different volume and surface-based atlas maps)</li></ul><h2 id=20220111>20220111</h2><ul><li>a deep learning based vessel segmentation algorithm &ldquo;vesselapp&rdquo; was added in version 0.3.1</li><li>palm - Permutation Analysis of Linear Models - was added in version alpha119</li><li>niistat running in octave was added with version 1.0.20191216</li><li>MRIcroGL was updated to a version with included python support, so the scripting is now working</li><li>rabies - Rodent Automated Bold Improvement of EPI Sequences was added with version 0.3.5</li><li>oshyx was updated to 0.3</li></ul><h2 id=20211220>20211220</h2><ul><li>neurodesktop can now be accessed via native RDP client as well (e.g. for multi-monitor support): <a href=https://www.neurodesk.org/docs/neurodesktop/getting-started/windows/#using-an-rdp-client>https://www.neurodesk.org/docs/neurodesktop/getting-started/windows/#using-an-rdp-client</a></li><li>there is a new Help button in the menu :)</li><li>updates of ants 2.3.4 (now includes Scripts as well, including antsCookTemplatePriors.sh) + newly added version 2.3.5</li><li>new version of QSMxT 1.1.9 20211219</li><li>new version of Spinal Cord Toolbox 5.4</li><li>new tools: MRIcroGL and surfice - fantastic viewers for neuroimaging data</li></ul><h2 id=20211207>20211207</h2><ul><li>Physio toolbox compiled and added to SPM + update of SPM</li><li>added brainstorm</li><li>new neurodesktop container management scripts for Linux, Mac and Windows: <a href=https://github.com/NeuroDesk/neurodesktop>https://github.com/NeuroDesk/neurodesktop</a></li><li>added fieldtrip</li><li>Datalad is now in the main image, so datalad run should work</li><li>added Oshy-X segmentation tool</li><li>updated freesurfer 7.2.0</li></ul><h2 id=20211028>20211028</h2><ul><li>added EEGLAB</li></ul><h2 id=20211018>20211018</h2><ul><li>added Rstudio, R and multiple R packages (plotly, car, tidyverse, &mldr;)</li><li>added ClearSWI and ROMEO for MRI phase processing (including new Tutorials: <a href=https://www.neurodesk.org/tutorials/phase_processing/>https://www.neurodesk.org/tutorials/phase_processing/</a>)</li><li>added more categories in applications menu (Body, Electrophysiology, Hippocampus, Phase Processing, Rodent Imaging, Shape Analysis, Spine, Statistics)</li><li>bugfix: improved startup time of the desktop container (miniconda in homedirectory was causing chmod slowdown)</li><li>bugfix: ssh, vnc and rdp servers are now restarted in case the container was stopped and started again (e.g. on Standby)</li></ul><h2 id=20210929>20210929</h2><ul><li>fixed naming of aidmri to aidamri and added new category &ldquo;Rodent Imaging&rdquo;</li><li>updated all tool icons and updated neurodesk icon including background image</li><li>VScode now stores settings in persistent storage /neurodesktop-storage and with this keeps extensions and settings across different neurodesktop versions</li><li>docker layers are now cached, so updating the desktop to the next version is very fast and consumes less disk space locally</li><li>default theme of terminal changed from Solarized to Tango as the old theme was hiding information in tools like htop (same font colour on same background&mldr;)</li></ul><h2 id=20210923>20210923</h2><ul><li>removed faulty mriqc 0.15.2 container</li><li>neurodesk.github.io is now starting page in firefox browser</li></ul><h2 id=20210918>20210918</h2><ul><li>added mriqc 0.16.1 and mrtrix 3.0.3</li></ul><h2 id=20210917>20210917</h2><ul><li>included more tools for connecting to cloud storage services (rclone, owncloud, nextcloud, davfs2, globus). For more info: <a href=/docs/neurodesktop/storage>Storage</a></li><li>styling of desktop interface, including background wallpaper and colour scheme in terminal window</li><li>new categories in menu system (visualization) and added more categories to tools</li></ul><h2 id=20210916>20210916</h2><ul><li>This is the first version of the newly renamed and rebuild neurodesktop (previously vnm and neuromachine)</li><li>containers are mounted by default from CVMFS, but this can be deactivated by adding <code>-e CVMFS_DISABLE=true</code> to the docker call</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-216e6b441d02e354a557e95ac5aff8f4>5 - Neurocommand</h1><div class=lead>For more advanced users who prefer a command-line interface</div><p>Neurocommand requires a Linux host machine, virtual machine or WSL for Windows.</p></div><div class=td-content><h1 id=pg-7dcdaf2682aade0e69b4813cd0359095>5.1 - Getting Started</h1><div class=lead>Select your operating system to get started with neurocommand.</div></div><div class=td-content><h1 id=pg-b25aa0b6f8dfd4ff32d8bffbdca60e3b>5.1.1 - Linux</h1><div class=lead>Install neurocommand on Linux</div><h1 id=ways-of-using-neurocommand-in-linux>Ways of using Neurocommand in Linux:</h1><ol><li>You can use Neurocontainers directly via CVMFS: <a href=https://www.neurodesk.org/docs/neurocontainers/cvmfs/>https://www.neurodesk.org/docs/neurocontainers/cvmfs/</a></li><li>or you can install Neurocommand as described here:</li></ol><h2 id=requirements>Requirements:</h2><h3 id=required>Required</h3><ul><li>python 3.6+ <a href=https://docs.conda.io/en/latest/miniconda.html#linux-installers>https://docs.conda.io/en/latest/miniconda.html#linux-installers</a></li><li>singularity <a href=https://sylabs.io/guides/3.5/user-guide/quick_start.html>https://sylabs.io/guides/3.5/user-guide/quick_start.html</a></li><li>git</li></ul><h3 id=optional>Optional</h3><ul><li>lmod <a href=https://sylabs.io/guides/3.5/user-guide/quick_start.html>https://lmod.readthedocs.io/en/latest/</a></li></ul><h3 id=command-line-mode-eg-running-on-an-hpc-or-cvl>command line mode (e.g. running on an HPC or CVL)</h3><ul><li>Load singularity and for best performance it should be 3.x e.g. <code>module load singularity/3.5.0</code></li><li>Load or install aria2 to optimize the download performance of our containers e.g. <code>module load aria2c</code></li><li>Run <code>git clone https://github.com/NeuroDesk/neurocommand.git</code> to clone the repository - make sure to clone this to a directory with enough storage, write permissions and NOT a symbolic link (to be sure run cd `pwd -P`)!</li><li>Run <code>cd neurocommand</code> to change into the directory</li><li>Run <code>pip3 install -r neurodesk/requirements.txt --user</code> to install pre-requisite python packages</li><li>Run <code>bash build.sh --cli</code> to install in cli mode</li><li>Run <code>bash containers.sh</code> for installing indiviual containers or <code>bash containers.sh --all</code> for installing all containers</li><li>Run <code>module use $PWD/local/containers/modules/</code> to add the containers to your module search path. Add this to your .bashrc if working.</li><li>Run <code>ml avail</code> to see the installed containers at the top of the list (neurodesk containers will take preference over system modules with the same name). - If a container is not yet there run <code>ml --ignore_cache avail</code></li></ul><h3 id=for-lxde-desktops>For Lxde desktops</h3><p>If running on an lxde desktop&mldr;
Run <code>bash build.sh --lxde --edit</code></p><h3 id=for-mate-desktops>For Mate desktops</h3><p>Run <code>bash build.sh --init</code> (or <code>bash build.sh --lxde --edit</code>)<br>lxde/mate: Mate<br>installdir: Where all the neurocommand files will be stored (Default: ./local)<br>appmenu: The linux menu xml file. (Usually /etc/xdg/menus/****-applications.menu)<br>appdir: Location for the .desktop files for this linux desktop (Usually /usr/share/applications)<br>deskdir: Location for the .directory files for this linux desktop (Typically /usr/share/desktop-directories)</p><h3 id=for-desktop-menus>For desktop menus:</h3><p><code>sudo bash install.sh</code> to install<br><em>Creates symlinks to menu files in installation dir</em></p><p><code>sudo bash uninstall.sh</code> to uninstall<br><em>Removes symlinks</em></p><h2 id=to-update>To update</h2><p>Run <code>git pull</code><br>Run <code>bash build.sh</code><br><em>install.sh does not need to be run again</em></p><h3 id=to-download-all-containers>To download all containers</h3><p>Run <code>bash containers.sh --all</code></p></div><div class=td-content style=page-break-before:always><h1 id=pg-180aa3bd9988d06cd8c909d2dd3a6340>5.1.2 - Windows</h1><div class=lead>Install neurocommand on Windows</div><h2 id=wsl-w-ubuntu--lxde>WSL (w/ Ubuntu + LXDE)</h2><p>For more information on WSL: <a href=https://docs.microsoft.com/en-us/windows/wsl>https://docs.microsoft.com/en-us/windows/wsl</a></p><h3 id=setting-up>Setting up</h3><ol><li>Setup WSL2 using the following instructions <em>(Ubuntu 18.04 recommended)</em><br><a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>https://docs.microsoft.com/en-us/windows/wsl/install-win10</a>
<em>Proceed until a Ubuntu bash shell is available from the Windows Host</em><br><em>Run the remaining commands in the Bash shell</em></li><li><code>sudo apt-get install lxde</code> to install LXDE desktop in WSL</li><li>Reboot</li><li><code>sudo apt-get install xrdp</code> to install XRDP in WSL</li><li>Open <code>/etc/xrdp/xrdp.ini</code>
Change <code>port=3389</code> to <code>port=3390</code> and save</li><li>Run <code>echo startlxde > ~/.xsession</code></li></ol><h3 id=running>Running</h3><ol><li><code>sudo service xrdp start</code> to start xrdp server</li><li>Open Microsoft Remote Desktop Connection in Windows host</li><li>Connect to <code>localhost:3390</code></li><li>In the next login page, leave Session as <code>Xorg</code>. Enter your WSL username and password and click <code>OK</code></li><li>This should open an LXDE Linux Desktop environment. Follow <a href=/docs/neurocommand/getting-started/linux>Linux guide</a> from here on</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-88405e8e9824a3a23cd8fda56d2e5574>6 - Neurocontainers</h1><div class=lead>What neurocontainers are about</div></div><div class=td-content><h1 id=pg-895ed1135b9cdc0df128fddec565e375>6.1 - CVMFS</h1><div class=lead>Neurodesk Singularity Containers on CVMFS</div><h1 id=install-cvmfs>Install CVMFS</h1><p>First you need to install CVMFS. Follow the official instructions here: <a href=https://cvmfs.readthedocs.io/en/stable/cpt-quickstart.html#getting-the-software>https://cvmfs.readthedocs.io/en/stable/cpt-quickstart.html#getting-the-software</a></p><p>one example for Ubuntu in Windows Subsystem for Linux (WSL) could look like this:</p><pre class="language-batch command-line" data-prompt=">">
<code>sudo apt-get install lsb-release
wget https://ecsft.cern.ch/dist/cvmfs/cvmfs-release/cvmfs-release-latest_all.deb
sudo dpkg -i cvmfs-release-latest_all.deb
rm -f cvmfs-release-latest_all.deb
sudo apt-get update
sudo apt-get build-essential
sudo apt-get install cvmfs</code>
</pre><h1 id=configure-cvmfs>Configure CVMFS</h1><p>Once installed create the keys and configure the servers used:</p><pre class="language-batch command-line" data-prompt=">">
<code>sudo mkdir -p /etc/cvmfs/keys/ardc.edu.au/


echo "-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwUPEmxDp217SAtZxaBep
Bi2TQcLoh5AJ//HSIz68ypjOGFjwExGlHb95Frhu1SpcH5OASbV+jJ60oEBLi3sD
qA6rGYt9kVi90lWvEjQnhBkPb0uWcp1gNqQAUocybCzHvoiG3fUzAe259CrK09qR
pX8sZhgK3eHlfx4ycyMiIQeg66AHlgVCJ2fKa6fl1vnh6adJEPULmn6vZnevvUke
I6U1VcYTKm5dPMrOlY/fGimKlyWvivzVv1laa5TAR2Dt4CfdQncOz+rkXmWjLjkD
87WMiTgtKybsmMLb2yCGSgLSArlSWhbMA0MaZSzAwE9PJKCCMvTANo5644zc8jBe
NQIDAQAB
-----END PUBLIC KEY-----" | sudo tee /etc/cvmfs/keys/ardc.edu.au/neurodesk.ardc.edu.au.pub

echo "CVMFS_USE_GEOAPI=yes" | sudo tee /etc/cvmfs/config.d/neurodesk.ardc.edu.au.conf

echo 'CVMFS_SERVER_URL="http://cvmfs.neurodesk.org/cvmfs/@fqrn@;http://cvmfs-brisbane.neurodesk.org/cvmfs/@fqrn@;http://cvmfs-sydney.neurodesk.org/cvmfs/@fqrn@;http://cvmfs-frankfurt.neurodesk.org/cvmfs/@fqrn@;http://cvmfs-zurich.neurodesk.org/cvmfs/@fqrn@;http://cvmfs-toronto.neurodesk.org/cvmfs/@fqrn@;http://cvmfs-ashburn.neurodesk.org/cvmfs/@fqrn@;http://cvmfs.neurodesk.org/cvmfs/@fqrn@"' | sudo tee -a /etc/cvmfs/config.d/neurodesk.ardc.edu.au.conf 

echo 'CVMFS_KEYS_DIR="/etc/cvmfs/keys/ardc.edu.au/"' | sudo tee -a /etc/cvmfs/config.d/neurodesk.ardc.edu.au.conf

echo "CVMFS_HTTP_PROXY=DIRECT" | sudo tee  /etc/cvmfs/default.local
echo "CVMFS_QUOTA_LIMIT=5000" | sudo tee -a  /etc/cvmfs/default.local

sudo cvmfs_config setup

# this is only necessary for WSL:
sudo cvmfs_config wsl2_start

sudo cvmfs_config chksetup

ls /cvmfs/neurodesk.ardc.edu.au

sudo cvmfs_talk -i neurodesk.ardc.edu.au host probe
sudo cvmfs_talk -i neurodesk.ardc.edu.au host info

cvmfs_config stat -v neurodesk.ardc.edu.au</code>
</pre><h1 id=for-ubuntu-2204-users>For Ubuntu 22.04 users</h1><p>If configuring CVMFS returns the following error:</p><pre class="language-batch command-line" data-prompt=">">
<code>Error: failed to load cvmfs library, tried: './libcvmfs_fuse3_stub.so' '/usr/lib/libcvmfs_fuse3_stub.so' '/usr/lib64/libcvmfs_fuse3_stub.so' './libcvmfs_fuse_stub.so' '/usr/lib/libcvmfs_fuse_stub.so' '/usr/lib64/libcvmfs_fuse_stub.so'
./libcvmfs_fuse3_stub.so: cannot open shared object file: No such file or directory
/usr/lib/libcvmfs_fuse3_stub.so: cannot open shared object file: No such file or directory
/usr/lib64/libcvmfs_fuse3_stub.so: cannot open shared object file: No such file or directory
./libcvmfs_fuse_stub.so: cannot open shared object file: No such file or directory
libcrypto.so.1.1: cannot open shared object file: No such file or directory
/usr/lib64/libcvmfs_fuse_stub.so: cannot open shared object file: No such file or directory


Failed to read CernVM-FS configuration</code>
</pre><p>A temporary workaround is:</p><pre class="language-batch command-line" data-prompt=">">
<code>wget https://mirror.umd.edu/ubuntu/ubuntu/pool/main/o/openssl/libssl1.1_1.1.1f-1ubuntu2.15_amd64.deb
dpkg -i libssl1.1_1.1.1f-1ubuntu2.15_amd64.deb</code>
</pre><h1 id=install-singularityapptainer>install singularity/apptainer</h1><p>e.g. for Ubuntu/Debian:</p><pre class="language-batch command-line" data-prompt=">">
<code>export VERSION=1.18.3 OS=linux ARCH=amd64 && \
    wget https://dl.google.com/go/go$VERSION.$OS-$ARCH.tar.gz && \
    sudo tar -C /usr/local -xzvf go$VERSION.$OS-$ARCH.tar.gz && \
    rm go$VERSION.$OS-$ARCH.tar.gz

echo 'export GOPATH=${HOME}/go' >> ~/.bashrc && \
    echo 'export PATH=/usr/local/go/bin:${PATH}:${GOPATH}/bin' >> ~/.bashrc && \
    source ~/.bashrc

go get -d github.com/sylabs/singularity

export VERSION=v3.10.0 # or another tag or branch if you like && \
    cd $GOPATH/src/github.com/sylabs/singularity && \
    git fetch && \
    git checkout $VERSION # omit this command to install the latest bleeding edge code from master

export VERSION=3.10.0 && # adjust this as necessary \
    mkdir -p $GOPATH/src/github.com/sylabs && \
    cd $GOPATH/src/github.com/sylabs && \
    wget https://github.com/sylabs/singularity/releases/download/v${VERSION}/singularity-ce-${VERSION}.tar.gz && \
    tar -xzf singularity-ce-${VERSION}.tar.gz && \789
    cd ./singularity-ce-${VERSION} && \
    ./mconfig --without-seccomp --without-conmon

./mconfig --without-seccomp --without-conmon && \
    make -C ./builddir && \
    sudo make -C ./builddir install

export PATH="/usr/local/singularity/bin:${PATH}"</code>
</pre><h1 id=use-of-neurodesk-cvmfs-containers>use of Neurodesk CVMFS containers</h1><p>The containers are now available in /cvmfs/neurodesk.ardc.edu.au/containers/ and can be started with:</p><pre class="language-batch command-line" data-prompt=">">
<code>singularity shell /cvmfs/neurodesk.ardc.edu.au/containers/itksnap_3.8.0_20201208/itksnap_3.8.0_20201208.simg</code>
</pre><p>make sure that SINGULARITY_BINDPATH include the directories you want to work with:</p><pre class="language-batch command-line" data-prompt=">">
<code>export SINGULARITY_BINDPATH='/cvmfs,/mnt,/home'</code>
</pre><h1 id=wsl-doesnt-support-homedirectory---so-dont-mount-this>WSL doesn&rsquo;t support homedirectory - so don&rsquo;t mount this</h1><pre class="language-batch command-line" data-prompt=">">
<code>singularity shell --no-home /cvmfs/neurodesk.ardc.edu.au/containers/itksnap_3.8.0_20201208/itksnap_3.8.0_20201208.simg</code>
</pre><p>or configure permanently:</p><pre class="language-batch command-line" data-prompt=">">
<code>sudo vi /etc/singularity/singularity.conf</code>
</pre><p>set</p><pre class="language-batch command-line" data-prompt=">">
<code>mount home = no</code>
</pre><h1 id=install-module-system>install module system:</h1><pre class="language-batch command-line" data-prompt=">">
<code>sudo yum install lmod</code>
</pre><h1 id=configure-module-system>configure module system:</h1><p>content of /usr/share/module.sh :</p><pre class="language-batch command-line" data-prompt=">">
<code># system-wide profile.modules                                          #
# Initialize modules for all sh-derivative shells                      #
#----------------------------------------------------------------------#
trap "" 1 2 3

case "$0" in
    -bash|bash|*/bash) . /usr/share/lmod/6.6/init/bash ;;
       -ksh|ksh|*/ksh) . /usr/share/lmod/6.6/init/ksh ;;
       -zsh|zsh|*/zsh) . /usr/share/lmod/6.6/init/zsh ;;
          -sh|sh|*/sh) . /usr/share/lmod/6.6/init/sh ;;
                    *) . /usr/share/lmod/6.6/init/sh ;;  # default for scripts
esac

trap - 1 2 3</code>
</pre><h1 id=use-of-containers-in-the-module-system>use of containers in the module system:</h1><p>add this to .bashrc:</p><pre class="language-batch command-line" data-prompt=">">
<code>if [ -f '/usr/share/module.sh' ]; then source /usr/share/module.sh; fi

if [ -d /cvmfs/neurodesk.ardc.edu.au/neurodesk-modules ]; then
        # export MODULEPATH="/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules"
        module use /cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/*
else
        export MODULEPATH="/neurodesktop-storage/containers/modules"              
        module use $MODULEPATH
        export CVMFS_DISABLE=true
fi

if [ -f '/usr/share/module.sh' ]; then
        echo 'Run "ml av" to see which tools are available - use "ml <tool>" to use them in this shell.'
        if [ -v "$CVMFS_DISABLE" ]; then
                if [ ! -d $MODULEPATH ]; then
                        echo 'Neurodesk tools not yet downloaded. Choose tools to install from the Application menu.'
                fi
        fi
fi</code>
</pre><h1 id=use-of-containers-in-the-module-system-1>use of containers in the module system:</h1><pre class="language-batch command-line" data-prompt=">">
<code>export SINGULARITY_BINDPATH='/cvmfs,/mnt,/home'
module use /cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/*
ml fsl
fslmaths</code>
</pre></div><div class=td-content style=page-break-before:always><h1 id=pg-e6e34ad7485d3730bc92bfaf63f2eb30>6.2 - Datalad</h1><div class=lead>Neurodesktop containers can be used in datalad container run</div><p>Once this is completed: <a href=https://github.com/ReproNim/containers/issues/64#issuecomment-999126787>https://github.com/ReproNim/containers/issues/64#issuecomment-999126787</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-f18a87ac25493d50d810709d157e5b03>6.3 - Docker</h1><div class=lead>Neurodesk Docker containers</div><p>Our containers are automatically built in <a href=https://github.com/NeuroDesk/neurocontainers/>https://github.com/NeuroDesk/neurocontainers/</a> and hosted on <a href=https://hub.docker.com/orgs/vnmd/repositories>dockerhub</a> or on <a href=https://github.com/NeuroDesk/neurocontainers/packages>github</a></p><h2 id=pull-docker-containers>Pull Docker containers</h2><p>e.g. for a julia container
docker</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker pull vnmd/julia_1.6.1
</span></span></code></pre></div><p>build singularity image from dockerhub</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>singularity build julia_1.6.1.simg docker://vnmd/julia_1.6.1
</span></span></code></pre></div><p>Replace <code>julia_1.6.1</code> with your selected application. You can find the available containers here: <a href=https://www.neurodesk.org/applications/>https://www.neurodesk.org/applications/</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-1242611cf4181d837a23ff9db8482b26>6.4 - Google Colab</h1><div class=lead>Neurodesk Singularity Containers for Google Colab</div><p>This notebook demonstrates how to use all Neurodesk applications in Google Colab:
<a href="https://colab.research.google.com/drive/1g5cnZxj1llRaHmOs4xSglqsXnFkQYuol?usp=sharing">https://colab.research.google.com/drive/1g5cnZxj1llRaHmOs4xSglqsXnFkQYuol?usp=sharing</a></p><p><img src=https://user-images.githubusercontent.com/4021595/156729329-883d33a8-f6ae-4d79-ba71-0e1ced172069.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-dde076c9513b160da47a52346f74d655>6.5 - Singularity</h1><div class=lead>Neurodesk Singularity Containers</div><p>Our docker containers are converted to singularity containers and stored on Object storage.</p><h2 id=download-singularity-containers>Download Singularity Containers</h2><p>First get an overview which containers are available as Singularity containers:
<a href=https://github.com/NeuroDesk/neurodesk/blob/master/cvmfs/log.txt>https://github.com/NeuroDesk/neurodesk/blob/master/cvmfs/log.txt</a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl -s https://raw.githubusercontent.com/NeuroDesk/neurodesk/master/cvmfs/log.txt
</span></span></code></pre></div><p>assign the container name to a variable:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>container</span><span style=color:#ce5c00;font-weight:700>=</span>itksnap_3.8.0_20201208
</span></span></code></pre></div><p>Then download the containers. An easy way is to use CURL (e.g. downloading from the US location):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl -X GET https://objectstorage.us-ashburn-1.oraclecloud.com/n/sd63xuke79z3/b/neurodesk/o/<span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>.simg -O
</span></span></code></pre></div><p>or from australia</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl -X GET https://objectstorage.ap-sydney-1.oraclecloud.com/n/sd63xuke79z3/b/neurodesk/o/<span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>.simg -O
</span></span></code></pre></div><p>A faster way is pulling from multiple storage locations at once using aria2:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>aria2c https://objectstorage.us-ashburn-1.oraclecloud.com/n/sd63xuke79z3/b/neurodesk/o/<span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>.simg https://objectstorage.eu-frankfurt-1.oraclecloud.com/n/sd63xuke79z3/b/neurodesk/o/<span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>.simg https://objectstorage.ap-sydney-1.oraclecloud.com/n/sd63xuke79z3/b/neurodesk/o/<span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>.simg https://swift.rc.nectar.org.au/v1/AUTH_dead991e1fa847e3afcca2d3a7041f5d/neurodesk/<span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>.simg
</span></span></code></pre></div><h2 id=transparent-singularity>Transparent Singularity</h2><p>The singularity containers can be also be used in combination with our <a href=/developers/transparent_singularity//>Transparent Singularity Tool</a> tool, that wraps the executables inside a container to make them easily available for pipelines. More information can be found here:</p><p>one example to do this is:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl -s https://raw.githubusercontent.com/NeuroDesk/neurodesk/master/cvmfs/log.txt
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>container</span><span style=color:#ce5c00;font-weight:700>=</span>itksnap_3.8.0_20201208
</span></span><span style=display:flex><span>git clone https://github.com/NeuroDesk/transparent-singularity <span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> <span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>
</span></span><span style=display:flex><span>./run_transparent_singularity.sh <span style=color:#4e9a06>${</span><span style=color:#000>container</span><span style=color:#4e9a06>}</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-032a02c0f4ba2de0dd4a701cff6790fe>6.6 - Windows 11 and Windows Subsystem for Linux</h1><div class=lead>Use Neurocontainers on Windows 11 with WSL and Wayland Display Server</div><h2 id=1-install-wsl>1. Install WSL</h2><p>Follow the instructions to enable Windows Subsystem for Linux 2 in Windows 11: <a href=https://docs.microsoft.com/en-us/windows/wsl/install>https://docs.microsoft.com/en-us/windows/wsl/install</a></p><h2 id=2-configure-cvfms-singularity-and-lmod-only-needs-to-be-done-once>2. Configure CVFMS, Singularity and LMOD (only needs to be done once)</h2><h3 id=install-build-tools>Install build tools</h3><pre class="language-batch command-line" data-prompt=">">
<code>sudo apt update
sudo apt install make gcc </code>
</pre><h3 id=install-singularity>Install singularity</h3><pre class="language-batch command-line" data-prompt=">">
<code>export SINGULARITY_VERSION=3.9.3 VERSION=1.17.2 OS=linux ARCH=amd64
wget -q https://dl.google.com/go/go$VERSION.$OS-$ARCH.tar.gz 
sudo tar -C /usr/local -xzvf go$VERSION.$OS-$ARCH.tar.gz 
rm go$VERSION.$OS-$ARCH.tar.gz 
export GOPATH=${HOME}/go 
export PATH=/usr/local/go/bin:${PATH}:${GOPATH}/bin 
mkdir -p $GOPATH/src/github.com/sylabs 
cd $GOPATH/src/github.com/sylabs 
wget -q https://github.com/sylabs/singularity/releases/download/v${SINGULARITY_VERSION}/singularity-ce-${SINGULARITY_VERSION}.tar.gz 
tar -xzvf singularity-ce-${SINGULARITY_VERSION}.tar.gz 
cd singularity-ce-${SINGULARITY_VERSION} 
./mconfig --prefix=/usr/local/singularity 
make -C builddir 
sudo make -C builddir install 
cd .. 
sudo rm -rf singularity-ce-${SINGULARITY_VERSION} 
sudo rm -rf /usr/local/go $GOPATH </code>
</pre><h3 id=setup-bindpaths-for-singularity-eg-in-bashrc>Setup Bindpaths for Singularity (e.g. in .bashrc)</h3><pre class="language-batch command-line" data-prompt=">">
<code>export PATH="/usr/local/singularity/bin:${PATH}"
export SINGULARITY_BINDPATH='/cvmfs,/mnt,/home'</code>
</pre><h3 id=cvmfs>CVMFS</h3><p>Follow the instructions here: <a href=https://www.neurodesk.org/docs/neurocontainers/cvmfs/>https://www.neurodesk.org/docs/neurocontainers/cvmfs/</a></p><h3 id=lmod>LMOD</h3><pre class="language-batch command-line" data-prompt=">">
<code>apt install lmod</code>
</pre><h2 id=3-use-neurodesk-containers>3. Use Neurodesk containers</h2><pre class="language-batch command-line" data-prompt=">">
<code>module use /cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/*
ml av
ml fsl
fsleyes</code>
</pre></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/neuro_desk aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/NeuroDesk aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Dicussion Forum (requires github login)" aria-label="Dicussion Forum (requires github login)"><a class=text-white target=_blank rel=noopener href=https://github.com/NeuroDesk/neurodesk.github.io/discussions aria-label="Dicussion Forum (requires github login)"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/neurodesk.github.io/js/tabpane-persist.js></script>
<script src=/neurodesk.github.io/js/main.min.2b242016bd393aa86ff3b4500b2baae3b55d65f622435861b9338518eb4a5f69.js integrity="sha256-KyQgFr05Oqhv87RQCyuq47VdZfYiQ1hhuTOFGOtKX2k=" crossorigin=anonymous></script>
<script src=/neurodesk.github.io/js/prism.js></script></body></html>