<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.94.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/neurodesk.github.io/favicons/favicon.ico><link rel=apple-touch-icon href=/neurodesk.github.io/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/neurodesk.github.io/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/neurodesk.github.io/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-192x192.png sizes=192x192><title>Add tools | NeuroDesk</title><meta name=description content="Add a tool to neurodesktop
"><meta property="og:title" content="Add tools"><meta property="og:description" content="Add a tool to neurodesktop
"><meta property="og:type" content="article"><meta property="og:url" content="https://neuro-sevas/neurodesk.github.io/developers/new_tools/add_tool/"><meta property="article:section" content="developers"><meta property="article:modified_time" content="2022-07-29T16:07:23+10:00"><meta property="og:site_name" content="NeuroDesk"><meta itemprop=name content="Add tools"><meta itemprop=description content="Add a tool to neurodesktop
"><meta itemprop=dateModified content="2022-07-29T16:07:23+10:00"><meta itemprop=wordCount content="1520"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Add tools"><meta name=twitter:description content="Add a tool to neurodesktop
"><link rel=preload href=/neurodesk.github.io/scss/main.min.8ae326e95d9c6881ebe419ebd82c6634a8ac6728b2415ccd672d345f03b4cb1b.css as=style><link href=/neurodesk.github.io/scss/main.min.8ae326e95d9c6881ebe419ebd82c6634a8ac6728b2415ccd672d345f03b4cb1b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
<link rel=stylesheet href=/neurodesk.github.io/css/prism.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-221108279-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/neurodesk.github.io/><span class=navbar-logo></span><span class="text-uppercase font-weight-bold">NeuroDesk</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/docs/how-to-cite-us/><span>Cite</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/docs/><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/docs/faq/><span>FAQ</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/applications/><span>Applications</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/neurodesk.github.io/developers/><span class=active>Developers</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/neurodesk.github.io/tutorials/><span>Tutorials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/NeuroDesk target=_blank><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://twitter.com/neuro_desk target=_blank><span>News</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/neurodesk.github.io/offline-search-index.49958059539d8b508473f889b67a882f.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/neurodesk.github.io/offline-search-index.49958059539d8b508473f889b67a882f.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-neurodeskgithubiodevelopers-li><a href=/neurodesk.github.io/developers/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-neurodeskgithubiodevelopers><span>Developers</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodeveloperscontributors-li><a href=/neurodesk.github.io/developers/contributors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-neurodeskgithubiodeveloperscontributors><span>Contributors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-neurodeskgithubiodevelopersarchitecture-li><a href=/neurodesk.github.io/developers/architecture/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-neurodeskgithubiodevelopersarchitecture><span>Architecture</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersarchitecturerelease_process-li><a href=/neurodesk.github.io/developers/architecture/release_process/ title="Neurodesktop Release Process" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersarchitecturerelease_process><span>Release Process</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersarchitectureneurodesk-components-li><a href=/neurodesk.github.io/developers/architecture/neurodesk-components/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersarchitectureneurodesk-components><span>Neurodesk Architecture</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersarchitectureneurodesk-dev-li><a href=/neurodesk.github.io/developers/architecture/neurodesk-dev/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersarchitectureneurodesk-dev><span>Neurodesktop Dev</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-neurodeskgithubiodevelopersdocumentation-li><a href=/neurodesk.github.io/developers/documentation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-neurodeskgithubiodevelopersdocumentation><span>Documentation</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersdocumentationlocal-hugo-docsy-li><a href=/neurodesk.github.io/developers/documentation/local-hugo-docsy/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersdocumentationlocal-hugo-docsy><span>Local Hugo Docsy</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-neurodeskgithubiodevelopersnew_tools-li><a href=/neurodesk.github.io/developers/new_tools/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-neurodeskgithubiodevelopersnew_tools><span>How to add new tools</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersnew_toolscloning-li><a href=/neurodesk.github.io/developers/new_tools/cloning/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersnew_toolscloning><span>Get Neurodesk code</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersnew_toolsworkflow-li><a href=/neurodesk.github.io/developers/new_tools/workflow/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersnew_toolsworkflow><span>Using Git</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-neurodeskgithubiodevelopersnew_toolsadd_tool-li><a href=/neurodesk.github.io/developers/new_tools/add_tool/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersnew_toolsadd_tool><span class=td-sidebar-nav-active-item>Add tools</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersnew_toolsfix_commit-li><a href=/neurodesk.github.io/developers/new_tools/fix_commit/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersnew_toolsfix_commit><span>Fix commit</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersnew_toolspull_request-li><a href=/neurodesk.github.io/developers/new_tools/pull_request/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersnew_toolspull_request><span>Create a pull request</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersnew_toolstroubleshooting-li><a href=/neurodesk.github.io/developers/new_tools/troubleshooting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersnew_toolstroubleshooting><span>Troubleshooting</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodevelopersnew_toolsmenu_entries-li><a href=/neurodesk.github.io/developers/new_tools/menu_entries/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodevelopersnew_toolsmenu_entries><span>Menu entries</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodeveloperstransparent_singularity-li><a href=/neurodesk.github.io/developers/transparent_singularity/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-neurodeskgithubiodeveloperstransparent_singularity><span>Transparent Singularity</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-neurodeskgithubiodeveloperscvmfs-li><a href=/neurodesk.github.io/developers/cvmfs/ title="Neurodesk CVMFS" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-neurodeskgithubiodeveloperscvmfs><span>CVMFS</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodeveloperscvmfsproxy-li><a href=/neurodesk.github.io/developers/cvmfs/proxy/ title="Setup CVMFS Proxy" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodeveloperscvmfsproxy><span>Proxy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodeveloperscvmfscvmfs_architecture-li><a href=/neurodesk.github.io/developers/cvmfs/cvmfs_architecture/ title="CVMFS architecture" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodeveloperscvmfscvmfs_architecture><span>Setup</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodeveloperscvmfsstratum0-li><a href=/neurodesk.github.io/developers/cvmfs/stratum0/ title="Setup Stratum 0 server" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodeveloperscvmfsstratum0><span>Stratum 0</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-neurodeskgithubiodeveloperscvmfsstratum1-li><a href=/neurodesk.github.io/developers/cvmfs/stratum1/ title="Setup Stratum 1 server" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-neurodeskgithubiodeveloperscvmfsstratum1><span>Stratum 1</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/NeuroDesk/neurodesk.github.io/edit/hugo-docsy/content/en/developers/new_tools/add_tool.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/NeuroDesk/neurodesk.github.io/new/hugo-docsy/content/en/developers/new_tools/add_tool.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/NeuroDesk/neurodesk.github.io/issues/new?title=Add%20tools" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/NeuroDesk/neurodesk.github.io/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=https://neuro-sevas/neurodesk.github.io/developers/new_tools/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#guiding-principles>Guiding principles</a></li><li><a href=#adding-new-recipes>Adding new recipes</a></li><li><a href=#build-container>Build container</a><ul><li><a href=#environment-requirements>Environment Requirements</a></li><li><a href=#install-neurodocker>Install Neurodocker</a></li><li><a href=#clone-the-neurocontainers-repository>Clone the Neurocontainers repository</a></li><li><a href=#create-a-new-app>Create a new app</a></li><li><a href=#push-the-new-app-to-neurocontainers>Push the new app to Neurocontainers</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><h1>Add tools</h1><div class=lead>Add a tool to neurodesktop</div><header class=article-meta></header><p>The goal of <em>neurodesk</em> is to provide users with a large choice of tools to use in their pipelines.
Use the guide below to add a tool to <em>neurodesktop</em> or <em>neurocontainers</em>.</p><h2 id=guiding-principles>Guiding principles</h2><p>To decide if a tool should be packaged in a singularity container in <em>neurocontainers</em> or be installed in the <em>neurodesktop</em> container we are currently following these guiding principles:</p><ol><li><em>neurodesk</em> is not a package manager. This means we are not distributing tools in containers that can easily be installed via a standard package manager</li><li><em>neurodesk</em> allows users to have multiple versions of tools in parallel via <a href=https://lmod.readthedocs.io/en/latest/>lmod</a>, this means that if different versions of a tool can&rsquo;t be installed in parallel we package the tool inside a container.</li><li><em>neurodesk</em> aims to provide tooling to link tools from different containers (such as workflow managers like nipype or nextflow). This means that if a tool is required to coordinate various container-tools, it should be in the <em>neurodesktop</em> container.</li></ol><p>Examples:</p><table><thead><tr><th></th><th>easy install</th><th>coordinates containers</th><th>small in size</th><th>latest version is ok</th><th>useful to most users</th><th>Conclusion</th></tr></thead><tbody><tr><td>git</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>neurodesktop</td></tr><tr><td>lmod</td><td>no</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>neurodesktop</td></tr><tr><td>nipype</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>neurodesktop</td></tr><tr><td>vscode</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>neurodesktop</td></tr><tr><td>itksnap</td><td>yes</td><td>no</td><td>yes</td><td>yes</td><td>yes</td><td>container?</td></tr><tr><td>convert3D</td><td>yes</td><td>no</td><td>yes</td><td>no</td><td>no</td><td>container</td></tr><tr><td>fsl</td><td>no</td><td>no</td><td>no</td><td>no</td><td>no</td><td>container</td></tr><tr><td>mrtrix</td><td>no</td><td>no</td><td>no</td><td>no</td><td>no</td><td>container</td></tr><tr><td>freesurfer</td><td>no</td><td>no</td><td>no</td><td>no</td><td>no</td><td>container</td></tr></tbody></table><h2 id=adding-new-recipes>Adding new recipes</h2><p>Refer to <a href=https://github.com/NeuroDesk/neurodocker>neurodocker</a> for more information on neurodocker recipes</p><h2 id=build-container>Build container</h2><h3 id=environment-requirements>Environment Requirements</h3><ul><li>Docker</li><li>Recent Python Version<br>Search for &ldquo;python_requires&rdquo; in <a href=https://github.com/NeuroDesk/neurodocker/blob/master/setup.cfg>https://github.com/NeuroDesk/neurodocker/blob/master/setup.cfg</a> for minimal version of Python required. If you have several versions of Python installed in the environment, typing &lsquo;python&rsquo; in the terminal should launch a version with equal or higher version number</li><li>Python pip3<br>This should be launched by &lsquo;python -m pip&rsquo;</li><li>git</li></ul><h3 id=install-neurodocker>Install Neurodocker</h3><p>Neurodocker is the dependency we use to build containers.</p><ol><li>(optional) Sync upstream repository:<br>If you have the permissions to do so: Press &ldquo;Fetch upstream&rdquo; in <a href=https://github.com/NeuroDesk/neurodocker>https://github.com/NeuroDesk/neurodocker</a> to check if our fork of Neurodocker is already up-to-date. Otherwise, open an issue in <a href=https://github.com/NeuroDesk/neurocontainers/issues>https://github.com/NeuroDesk/neurocontainers/issues</a>, requesting to pull-in latest changes from Neurodocker upstream into our fork of Neurodocker. One of the admins will attend the issue and perform the operation.</li><li>(optional) Add a new neurodocker tool:<br>If relevant to your project, add an option to neurodocker that installs new software (<a href=https://github.com/NeuroDesk/neurodocker>https://github.com/NeuroDesk/neurodocker</a>) and create a pull request to neurodocker&rsquo;s main responsitory (add new tool in a branch!).</li><li>Clone our fork of Neurodocker:<pre class="language-shell command-line" data-prompt=$><code>git clone https://github.com/NeuroDesk/neurodocker/</code></pre></li><li>Install neurodocker:<pre class="language-shell command-line" data-prompt=$><code>cd neurodocker  
python -m pip install .
cd ..</code></pre></li><li>Run:
echo &rsquo;export PATH=${PATH}:${HOME}/.local/bin&rsquo; &#187; ${HOME}/.bashrc</li><li>Close the terminal, and reopen it for the updated PATH to take effect</li></ol><h3 id=clone-the-neurocontainers-repository>Clone the Neurocontainers repository</h3><ul><li><p><em>Option A</em>) Fork neurocontainers and setup github actions:<br>Follow the steps in <a href=https://neuro-sevas/neurodesk.github.io/developers/new_tools/cloning/>Get Neurodesk code</a>.</p></li><li><p><em>Option B</em>) Clone from NeuroDesk:</p><pre class="language-shell command-line" data-prompt=$><code>git clone https://github.com/NeuroDesk/neurocontainers/</code></pre></li></ul><h3 id=create-a-new-app>Create a new app</h3><ol><li><p>Copy the directory template and rename to NEWAPP in <code>neurocontainers/recipes</code> (NEWAPP being the name of the application to be displayed in Neurodesk&rsquo;s menu; notice it shouldn&rsquo;t have any special characters):</p><pre class="language-shell command-line" data-prompt=$><code>cd neurocontainers/recipes
cp -R template NEWAPP</code></pre></li><li><p>Create your Container Files:<br>Modify <code>build.sh</code> in <code>neurocontainers/recipes/NEWAPP</code> to build your application and update <code>README.md</code> (make sure the version is correct in the README!). Notice that the example build script in the template has instructions to build a conatiner for datalad, that may or may not suite your exact needs</p><pre class="language-shell command-line" data-prompt=$ data-output=2-3><code>cd NEWAPP
(edit build.sh as required)
(edit README.md as required)</code></pre><p>Upload your application to object storage first if needed, so you can then download it in <code>build.sh</code> (ask for instructions about this if you don&rsquo;t know the key, and never share it anywhere public!)</p></li><li><p>Run <code>update-builders.sh</code>:
This will auto-create the CI workflow for the application (or manually duplicate the template file and rename all occurances of template to NEWAPP)</p><pre class="language-shell command-line" data-prompt=$><code>cd ../..
sh update-builders.sh</code></pre><div class="alert alert-primary" role=alert>If the CI build runs out of space, add the application to the following txt file to add additional space:
<a href=https://github.com/NeuroDesk/neurocontainers/blob/master/.github/workflows/free-up-space-list.txt>https://github.com/NeuroDesk/neurocontainers/blob/master/.github/workflows/free-up-space-list.txt</a>.
Note: this increases CI run time, only use in cases of out-of-space errors.</div></li><li><p>Build and test the container locally</p><ol><li><p>run the build script with the debug flag:</p><pre class="language-shell command-line" data-prompt=$><code>cd recipes/NEWAPP
chmod +x build.sh
./build.sh -ds</code></pre><p>NOTICE: if the README.md file does not contain the same tool-version string as in the build.sh the build will not start to prevent an incorrect README.md description.</p></li><li><p>test running some commands within the container that should be available in your local docker container repository.</p><p>For example, to open an interactive shell in a container (with the home folder /root binded to /root on host), you may run:</p><pre class="language-shell command-line" data-prompt=$><code>sudo docker run -it -v /root:/root --entrypoint /bin/bash NEWAPP_VERSION:TAG
</code></pre><p>with VERSION being the version of the app, and TAG the version tag of the container (run &lsquo;sudo docker image list&rsquo; to find the tag)</p></li><li><p>if your application requires a Matlab Runtime and you get an error about shared library &ldquo;libmwlaunchermain.so&rdquo; not found, check which version of the runtime was installed by the build script</p></li></ol></li><li><p>Update changes in local git repository</p><pre class="language-shell command-line" data-prompt=$><code>git add .github/workflows/NEWAPP.yml recipes/NEWAPP/test.sh recipes/NEWAPP/build.sh recipes/NEWAPP/README.md
git config user.email "the email that you use for github"
git config user.name "your name"
git commit</code></pre></li></ol><h3 id=push-the-new-app-to-neurocontainers>Push the new app to Neurocontainers</h3><p><strong>Prerequisite</strong></p><p>Generate git personal access token (if you don’t have one already)</p><ol><li>Browse to <a href=https://github.com/>https://github.com/</a></li><li>Log into your account</li><li>Press on your picture in upper right corner &ndash;> Setting &ndash;> Developer Settings &ndash;> Personal Access Token</li><li>Press on “generate personal access token”</li><li>Write something in “Notes” (doesn’t matter what, it’s for your own use)</li><li>Check “repo”</li><li>Check “Workflow”</li><li>Press “Generate Token” at the bottom</li><li>Copy the token displayed to somewhere safe, as you will have to user it later</li></ol><p><strong>Step by step guide</strong></p><ol><li><p>Test the container locally, and if successful push repo to trigger the automatic build on GitHub. When asked for your Github password, please provide the personal access token obtained in the previous stage.</p><pre class="language-shell command-line" data-prompt=$><code>git pull
git push</code></pre></li><li><p>Go to <a href=https://github.com/neurodesk/neurocontainers/actions>https://github.com/neurodesk/neurocontainers/actions</a>. Check that the most recent workflow run in the list terminated successfully (green). Otherwise, click on it, click on “build docker”, and the line that caused the error will be highlighted</p></li><li><p>Find your new package under <a href="https://github.com/orgs/NeuroDesk/packages?repo_name=neurocontainers">https://github.com/orgs/NeuroDesk/packages?repo_name=neurocontainers</a><br>Enter the name of the package in the search box, and verify that the full package name shows up in the format <em>toolName_toolVersion</em></p></li><li><p>Obtain <em>buildDate</em> by clicking on the full package name that came up in the search. The build date will be the newest date shown under <strong>Recent tagged image versions</strong></p></li><li><p>Use <em>toolName</em>, <em>toolVersion</em> and <em>buildDate</em> from the previous two steps to manually download the package by typing the following in a terminal open in Neurodesktop</p><pre class="language-shell command-line" data-prompt=$><code>bash /neurocommand/local/fetch_and_run.sh toolName toolVersion buildDate
   (when you see the "Singularity>" prompt, type exit and ENTER)
 ml toolName/toolVersion</code></pre><p>For example:
If the full package name that comes up in the step 11 is itksnap_3.8.0, and the newest date under <strong>Recent tagged image versions</strong> is 20210322</p><p>The command to use in a terminal open in Neurodesktop is:</p><pre class="language-shell command-line" data-prompt=$><code>bash /neurocommand/local/fetch_and_run.sh itksnap 3.8.0 20210322
  (when you see the "Singularity>" prompt, type exit and ENTER)
 ml toolName/toolVersion</code></pre></li></ol><div class="alert alert-warning" role=alert><h4 class=alert-heading>Depreciation notice</h4><p>For VNM users use:</p><pre class="language-shell command-line" data-prompt=$><code>bash /neurodesk/local/fetch_and_run.sh toolName toolVersion buildDate
  ml toolName/toolVersion</code></pre></div><ol start=6><li><p>Test the new container. Run some commands, to see all is good<br>If the container doesn&rsquo;t work yet, it&rsquo;s sometimes useful to try and troubleshoot it and install missing libraries. This can be achieved by running it in a writable mode with fakeroot enabled:</p><pre class="language-shell command-line" data-prompt=$><code>SINGULARITY_BINDPATH=''; singularity shell --writable --fakeroot /neurodesktop-storage/containers/toolName_toolVersion_buildDate/toolName_toolVersion_buildDate.simg</code></pre></li><li><p>Fork <a href=https://github.com/NeuroDesk/neurocommand/>https://github.com/NeuroDesk/neurocommand/</a> to your Github account</p></li><li><p>Edit an entry for your package in your fork of <code>neurocommand/blob/main/neurodesk/apps.json</code> based on one of the other entries (generating one menu item for opening a terminal inside the containers, and one menu item for the GUI, if relevant). Notice that in the json file, the version field should contain the <em>buildDate</em></p></li><li><p>Include an icon file in your fork of neurocommand/neurodesk/icons</p></li><li><p>Send a pull request from your fork of neurocommand to <a href=https://github.com/NeuroDesk/neurocommand/>https://github.com/NeuroDesk/neurocommand/</a></p></li><li><p>When the pull request is merged by Neurodesk admins, it will trigger an action to build the singularity container, distribute it in all object storage locations and on CVMFS, and it will update the menus in the desktop image on the next daily build.</p></li><li><p>Wait at least 24 hours</p></li><li><p>Download and run the daily build of neurodesktop to check that your app can be launched from the start menu and works properly:</p><pre class="language-shell command-line" data-prompt=$><code>sudo docker pull vnmd/neurodesktop:latest && sudo docker run   --shm-size=1gb -it --privileged --name neurodesktop   -v ~/neurodesktop-storage:/neurodesktop-storage   -e HOST_UID="$(id -u)" -e HOST_GID="$(id -g)"   -p 8080:8080 -h neurodesktop-latest   vnmd/neurodesktop:latest</code></pre></li><li><p>Open an issue in <a href=https://github.com/NeuroDesk/neurocontainers/issues>https://github.com/NeuroDesk/neurocontainers/issues</a> notifying that your app appears in the start menu and tested. The app will be included in the next release of Neurodesktop, and will be mentioned in the public announcement that accompanies the release. If the app is not in the start menu or not working as expected based on your earlier testing, open an issue as well, and report it.</p></li><li><p>If somebody wants to use the application before the next release of Neurodesktop is out, you can instruct them to use the command in step 13 above instead of the deafult commands given in the user install instructions.</p></li><li><p>Consider contributing a tutorial about the new tool: <a href=https://github.com/NeuroDesk/neurodesk.github.io/tree/hugo-docsy/content/en/tutorials>https://github.com/NeuroDesk/neurodesk.github.io/tree/hugo-docsy/content/en/tutorials</a></p></li></ol><div class="text-muted mt-5 pt-3 border-top">Last modified
July 29, 2022
: <a href=https://github.com/NeuroDesk/neurodesk.github.io/commit/63b543c8b1d98eec2b189ce128df8134e95fd1ad>added the notice that people need to update the README.md with the correct version string (63b543c8)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/neuro_desk aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/NeuroDesk aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Dicussion Forum (requires github login)" aria-label="Dicussion Forum (requires github login)"><a class=text-white target=_blank rel=noopener href=https://github.com/NeuroDesk/neurodesk.github.io/discussions aria-label="Dicussion Forum (requires github login)"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/neurodesk.github.io/js/tabpane-persist.js></script>
<script src=/neurodesk.github.io/js/main.min.2b242016bd393aa86ff3b4500b2baae3b55d65f622435861b9338518eb4a5f69.js integrity="sha256-KyQgFr05Oqhv87RQCyuq47VdZfYiQ1hhuTOFGOtKX2k=" crossorigin=anonymous></script>
<script src=/neurodesk.github.io/js/prism.js></script></body></html>